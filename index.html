<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Alpha 交易赛分析终端</title>
    
    <!-- PWA Configuration -->
    <meta name="application-name" content="AlphaDash">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AlphaDash">
    <meta name="theme-color" content="#000000">

    <!-- Dynamic App Icon (SVG Data URI) -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236366f1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z'/%3E%3Cpath d='M19 3v4'/%3E%3Cpath d='M21 5h-4'/%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%230f172a' stroke='%236366f1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='24' height='24' fill='white'/%3E%3Cpath d='M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z'/%3E%3Cpath d='M19 3v4'/%3E%3Cpath d='M21 5h-4'/%3E%3C/svg%3E">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#020617',
                            card: '#0f172a',
                            border: 'rgba(255, 255, 255, 0.08)'
                        }
                    },
                    animation: {
                        'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.12.7/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800&display=swap');
        
        body { font-family: 'Inter', sans-serif; overscroll-behavior-y: none; }
        .font-rounded { font-family: 'Nunito', sans-serif; }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #475569; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Animation Utility Classes */
        .animate-in { animation-duration: 0.3s; animation-fill-mode: both; }
        .fade-in { animation-name: fadeIn; }
        .zoom-in-95 { animation-name: zoomIn95; }
        .slide-in-from-top-2 { animation-name: slideInFromTop2; }
        .slide-in-from-bottom-4 { animation-name: slideInFromBottom4; }
        .slide-in-from-left-2 { animation-name: slideInFromLeft2; }

        @keyframes slideInFromLeft2 {
            from { transform: translateX(-0.5rem); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Glassmorphism */
        .glass-panel {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }
        
        /* Shimmer Effect */
        @keyframes shimmer {
            0% { transform: translateX(-150%) skewX(-20deg); }
            40%, 100% { transform: translateX(150%) skewX(-20deg); }
        }
        .animate-shimmer {
            animation: shimmer 3s infinite linear; 
        }

        /* Progress Stripes */
        @keyframes progress-stripes {
            0% { background-position: 1rem 0; }
            100% { background-position: 0 0; }
        }
        .animate-stripes {
            background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);
            background-size: 1rem 1rem;
            animation: progress-stripes 1s linear infinite;
        }

        /* Pulse Ring */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 0.5; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        .animate-pulse-ring {
            animation: pulse-ring 2s cubic-bezier(0, 0, 0.2, 1) infinite;
        }
        
        /* Dragging Styles */
        .draggable-card {
            cursor: grab;
            transition: transform 0.25s cubic-bezier(0.2, 0, 0.2, 1), opacity 0.2s;
            touch-action: none; /* Important for mobile drag */
        }
        .draggable-card:active {
            cursor: grabbing;
            transform: scale(1.02);
            z-index: 50;
        }
        /* Enhanced Dashed Placeholder Style */
        .draggable-card.dragging {
            opacity: 1; 
        }
        .draggable-card.dragging > div {
             opacity: 1 !important;
             border: 2px dashed #6366f1 !important;
             background-color: rgba(99, 102, 241, 0.05) !important; 
             box-shadow: none !important;
             backdrop-filter: none !important;
             transform: scale(0.95); 
             border-radius: 1.5rem !important;
        }
        .dark .draggable-card.dragging > div {
            background-color: rgba(99, 102, 241, 0.15) !important;
            border-color: #818cf8 !important;
        }
        .draggable-card.dragging > div > * {
            opacity: 0 !important;
            pointer-events: none;
        }
        
        /* Input Autofill Fix for Dark Mode */
        .dark input:-webkit-autofill,
        .dark input:-webkit-autofill:hover, 
        .dark input:-webkit-autofill:focus, 
        .dark input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px #0f172a inset !important;
            -webkit-text-fill-color: white !important;
        }
        
        input:-webkit-autofill,
        input:-webkit-autofill:hover, 
        input:-webkit-autofill:focus, 
        input:-webkit-autofill:active {
            -webkit-box-shadow: 0 0 0 30px #f8fafc inset !important;
            -webkit-text-fill-color: #0f172a !important;
        }
    </style>
</head>
<body class="bg-slate-50 dark:bg-black text-slate-900 dark:text-slate-200 selection:bg-blue-500/30 transition-colors duration-300 p-2 md:p-4">
    <div id="root"></div>

    <script type="text/babel">
        const { AreaChart, Area, ComposedChart, Bar, Line, Cell, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Legend } = window.Recharts;
        const { useState, useMemo, useEffect, useRef, useCallback } = React;

        // --- Core Components ---

        // Icon Component
        const Icon = ({ name, size = 16, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    iconRef.current.innerHTML = '';
                    const iconElement = document.createElement('i');
                    iconElement.setAttribute('data-lucide', name);
                    if (className) iconElement.className = className;
                    iconElement.style.width = `${size}px`;
                    iconElement.style.height = `${size}px`;
                    iconElement.style.display = 'inline-block';
                    iconRef.current.appendChild(iconElement);
                    window.lucide.createIcons({
                        attrs: { strokeWidth: 2, width: size, height: size },
                        nameAttr: 'data-lucide',
                        icons: window.lucide.icons
                    });
                }
            }, [name, size, className]);
            return <span ref={iconRef} className={`inline-flex items-center justify-center ${className}`} style={{ width: size, height: size }}></span>;
        };

        // Custom Tooltip
        const CustomTooltip = ({ active, payload, label, t }) => {
            if (active && payload && payload.length) {
                return (
                    <div className="bg-white/95 dark:bg-[#0f172a]/95 backdrop-blur-xl p-4 rounded-2xl border border-slate-200 dark:border-white/10 shadow-xl dark:shadow-[0_0_40px_-10px_rgba(0,0,0,0.7)] min-w-[200px] z-50">
                        <p className="text-slate-500 dark:text-slate-400 text-[10px] font-bold uppercase tracking-wider mb-3">{label}</p>
                        <div className="flex items-center justify-between gap-4 mb-2">
                            <div className="flex items-center gap-2">
                                <div className="w-1.5 h-1.5 rounded-full bg-blue-500 shadow-md"></div>
                                <span className="text-xs text-slate-600 dark:text-slate-300 font-medium">{t.legendThreshold}</span>
                            </div>
                            <span className="text-sm font-mono font-bold text-slate-900 dark:text-white">${payload[0].value.toLocaleString()}</span>
                        </div>
                        {payload[1] && (
                            <div className="flex items-center justify-between gap-4">
                                <div className="flex items-center gap-2">
                                    <div className="w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-md"></div>
                                    <span className="text-xs text-slate-600 dark:text-slate-300 font-medium">{t.legendUser}</span>
                                </div>
                                <span className="text-sm font-mono font-bold text-emerald-600 dark:text-emerald-400">
                                    ${payload[1].value.toLocaleString()}
                                </span>
                            </div>
                        )}
                        {payload[1] && (
                            <div className={`mt-3 pt-2 border-t border-slate-100 dark:border-white/10 text-xs font-bold flex justify-between ${payload[1].value >= payload[0].value ? 'text-emerald-600 dark:text-emerald-500' : 'text-rose-600 dark:text-rose-500'}`}>
                                <span>{payload[1].value >= payload[0].value ? t.statusSafe : t.statusRisk}</span>
                                <span>{payload[1].value >= payload[0].value ? '+' : ''}{((payload[1].value - payload[0].value) / payload[0].value * 100).toFixed(1)}%</span>
                            </div>
                        )}
                    </div>
                );
            }
            return null;
        };

        // --- Card Components ---
        // 1. Reward Card
        const RewardCard = ({ stats, coinPrice, currentComp, t }) => (
            <div className="relative rounded-3xl p-[1px] bg-gradient-to-br from-amber-300 via-orange-400 to-yellow-400 shadow-sm hover:shadow-xl dark:shadow-lg dark:hover:shadow-amber-900/30 transition-all duration-300 group h-full">
                <div className="relative overflow-hidden bg-white dark:bg-[#1a1005]/90 active:bg-slate-200 dark:active:bg-slate-950 backdrop-blur-md rounded-[23px] h-full p-4 md:p-6 flex flex-col">
                    {/* Drag Handle */}
                    <div className="absolute top-3 right-3 z-20 opacity-30 group-hover:opacity-100 transition-opacity duration-200 cursor-grab active:cursor-grabbing">
                        <Icon name="grip-horizontal" size={20} className="text-amber-900/40 dark:text-amber-100/40" />
                    </div>

                    <div className="absolute inset-0 bg-gradient-to-br from-amber-100/50 dark:from-amber-900/20 to-transparent opacity-50"></div>
                    <div className="absolute -right-4 -top-4 opacity-[0.15] group-hover:opacity-[0.25] transition-all duration-500 transform group-hover:scale-110 group-active:scale-125 group-hover:rotate-12 group-active:rotate-12">
                        <Icon name="gift" size={120} className="text-amber-500 dark:text-amber-300" />
                    </div>
                    <div className="relative z-10 flex-1 flex flex-col">
                        <div className="flex items-center gap-3 mb-3">
                            <div className="relative">
                                 <div className="absolute inset-0 rounded-xl animate-pulse-ring bg-amber-500"></div>
                                 <div className="relative z-10 w-8 h-8 rounded-xl border flex items-center justify-center bg-amber-100 dark:bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-200 dark:border-amber-500/20"><Icon name="coins" size={18} /></div>
                            </div>
                            <div className="text-amber-900/70 dark:text-amber-200/70 text-xs font-bold uppercase tracking-widest">{t.rewardEst}</div>
                        </div>
                        <div className="flex items-baseline gap-0.5 text-amber-950 dark:text-white">
                            <span className="text-xl font-bold text-amber-600/70 dark:text-amber-400/70">$</span>
                            <span className="text-4xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg">
                                {stats.latestReward ? (stats.latestReward * coinPrice).toLocaleString(undefined, {maximumFractionDigits: 2}) : '0.00'}
                            </span>
                        </div>
                        
                        <div className="mt-2 flex items-center justify-between">
                            <div className="text-[10px] font-bold text-amber-950 dark:text-white flex items-center justify-center bg-amber-50 dark:bg-amber-900/30 px-2 py-0.5 rounded-md border border-amber-100 dark:border-amber-500/20">
                                <span>
                                    {stats.latestReward ? stats.latestReward.toLocaleString() : '-'} 
                                    <span className="opacity-60 ml-0.5">{currentComp.symbol}</span>
                                </span>
                            </div>

                            <div className="text-[10px] font-bold text-amber-950 dark:text-white flex items-center justify-center bg-amber-50 dark:bg-amber-900/30 px-2 py-0.5 rounded-md border border-amber-100 dark:border-amber-500/20">
                                <span>
                                    <span className="opacity-60 mr-0.5">TOP</span> 
                                    {stats.latestEligibility ? stats.latestEligibility : '-'}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );

        // 2. Prediction Card
        const PredictionCard = ({ stats, t }) => (
            <div className="relative rounded-3xl p-[1px] bg-gradient-to-br from-violet-300 via-purple-400 to-fuchsia-400 shadow-sm hover:shadow-xl dark:shadow-lg dark:hover:shadow-violet-900/30 transition-all duration-300 group h-full">
                <div className="relative overflow-hidden bg-white dark:bg-[#150a1f]/90 active:bg-slate-200 dark:active:bg-slate-950 backdrop-blur-md rounded-[23px] h-full p-4 md:p-6 flex flex-col">
                    {/* Drag Handle */}
                    <div className="absolute top-3 right-3 z-20 opacity-30 group-hover:opacity-100 transition-opacity duration-200 cursor-grab active:cursor-grabbing">
                        <Icon name="grip-horizontal" size={20} className="text-violet-900/40 dark:text-violet-100/40" />
                    </div>

                    <div className="absolute inset-0 bg-gradient-to-br from-violet-100/50 dark:from-violet-900/20 to-transparent opacity-50"></div>
                    <div className="absolute -right-4 -top-4 opacity-[0.15] group-hover:opacity-[0.25] transition-all duration-500 transform group-hover:scale-110 group-active:scale-125 group-hover:-rotate-12 group-active:-rotate-12">
                        <Icon name="sparkles" size={120} className="text-violet-500 dark:text-violet-300" />
                    </div>
                    <div className="relative z-10 flex-1 flex flex-col">
                        <div className="flex items-center gap-3 mb-3">
                            <div className="relative">
                                <div className="absolute inset-0 rounded-xl animate-pulse-ring bg-violet-500"></div>
                                <div className="relative z-10 w-8 h-8 rounded-xl border flex items-center justify-center bg-violet-100 dark:bg-violet-500/10 text-violet-600 dark:text-violet-400 border-violet-200 dark:border-violet-500/20"><Icon name="bot" size={18} /></div>
                            </div>
                            <div className="text-violet-900/70 dark:text-violet-200/70 text-xs font-bold uppercase tracking-widest">{t.predictedNext}</div>
                        </div>
                        <div className="flex items-baseline gap-0.5 text-violet-950 dark:text-white">
                            <span className="text-xl font-bold text-violet-600/70 dark:text-violet-400/70">$</span>
                            <span className="text-3xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg">{stats.predictedNext.toLocaleString(undefined, {maximumFractionDigits:0})}</span>
                        </div>
                        <div className="mt-2 text-xs font-medium text-violet-700/80 dark:text-violet-400/80">
                            {t.linearTrend}
                        </div>
                    </div>
                </div>
            </div>
        );

        // 3. Threshold Card
        const ThresholdCard = ({ stats, t }) => (
            <div className="relative rounded-3xl p-[1px] bg-gradient-to-br from-blue-300 via-cyan-400 to-indigo-400 shadow-sm hover:shadow-xl dark:shadow-lg dark:hover:shadow-blue-900/30 transition-all duration-300 group h-full">
                <div className="relative overflow-hidden bg-white dark:bg-[#0a121f]/90 active:bg-slate-200 dark:active:bg-slate-950 backdrop-blur-md rounded-[23px] h-full p-4 md:p-6 flex flex-col">
                    {/* Drag Handle */}
                    <div className="absolute top-3 right-3 z-20 opacity-30 group-hover:opacity-100 transition-opacity duration-200 cursor-grab active:cursor-grabbing">
                        <Icon name="grip-horizontal" size={20} className="text-blue-900/40 dark:text-blue-100/40" />
                    </div>

                    <div className="absolute inset-0 bg-gradient-to-br from-blue-100/50 dark:from-blue-900/20 to-transparent opacity-50"></div>
                    <div className="absolute -right-4 -top-4 opacity-[0.15] group-hover:opacity-[0.25] transition-all duration-500 transform group-hover:scale-110 group-active:scale-125 group-hover:rotate-12 group-active:rotate-12">
                        <Icon name="target" size={120} className="text-blue-500 dark:text-blue-300" />
                    </div>
                    <div className="relative z-10 flex-1 flex flex-col">
                        <div className="flex items-center gap-3 mb-3">
                            <div className="relative">
                                <div className="absolute inset-0 rounded-xl animate-pulse-ring bg-blue-500"></div>
                                <div className="relative z-10 w-8 h-8 rounded-xl border flex items-center justify-center bg-blue-100 dark:bg-blue-500/10 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-500/20"><Icon name="crosshair" size={18} /></div>
                            </div>
                            <div className="text-blue-900/70 dark:text-blue-200/70 text-xs font-bold uppercase tracking-widest">{t.currentThreshold}</div>
                        </div>
                        <div className="flex items-baseline gap-0.5 text-blue-950 dark:text-white">
                            <span className="text-xl font-bold text-blue-600/70 dark:text-blue-400/70">$</span>
                            <span className="text-3xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg">{stats.current.toLocaleString()}</span>
                        </div>
                        <div className="mt-2 flex items-center justify-between">
                            <div className="text-xs font-medium text-blue-700/80 dark:text-blue-400/80 flex items-center gap-1">
                                <div className="w-1.5 h-1.5 rounded-full bg-blue-600 dark:bg-blue-400 animate-pulse"></div> {t.liveUpdate}
                            </div>
                            <div className="text-[10px] font-bold text-blue-600/70 dark:text-blue-300/70 flex items-center gap-1 bg-blue-50 dark:bg-blue-900/30 px-2 py-0.5 rounded-md border border-blue-100 dark:border-blue-500/20">
                                <Icon name="user" size={10} />
                                ${stats.latestUserVolume.toLocaleString()}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        );

        // 4. Growth Card
        const GrowthCard = ({ stats, t }) => {
            const gradientClass = stats.growthRate >= 0 
                ? 'from-emerald-300 via-green-400 to-teal-400' 
                : 'from-rose-300 via-red-400 to-orange-400';
            
            const darkBgClass = stats.growthRate >= 0 
                ? 'dark:bg-[#022c22]/90' // Dark Emerald for positive
                : 'dark:bg-[#450a0a]/90'; // Dark Red for negative
                
            return (
                <div className={`relative rounded-3xl p-[1px] bg-gradient-to-br ${gradientClass} shadow-sm hover:shadow-xl dark:shadow-lg transition-all duration-300 group h-full`}>
                    <div className={`relative overflow-hidden bg-white ${darkBgClass} active:bg-slate-200 dark:active:bg-slate-950 backdrop-blur-md rounded-[23px] h-full p-4 md:p-6 flex flex-col`}>
                        {/* Drag Handle */}
                        <div className="absolute top-3 right-3 z-20 opacity-30 group-hover:opacity-100 transition-opacity duration-200 cursor-grab active:cursor-grabbing">
                            <Icon name="grip-horizontal" size={20} className={stats.growthRate >= 0 ? "text-emerald-900/40 dark:text-emerald-100/40" : "text-rose-900/40 dark:text-rose-100/40"} />
                        </div>

                        <div className={`absolute inset-0 bg-gradient-to-br ${stats.growthRate >= 0 ? 'from-emerald-100/50 dark:from-emerald-900/20' : 'from-rose-100/50 dark:from-rose-900/20'} to-transparent opacity-50`}></div>
                        <div className={`absolute -right-4 -top-4 opacity-[0.15] group-hover:opacity-[0.25] transition-all duration-500 transform group-hover:scale-110 group-active:scale-125 group-hover:-rotate-12 group-active:-rotate-12 ${stats.growthRate >= 0 ? 'text-emerald-500 dark:text-emerald-300' : 'text-rose-500 dark:text-rose-300'}`}>
                            <Icon name={stats.growthRate >= 0 ? "trending-up" : "trending-down"} size={120} />
                        </div>
                        <div className="relative z-10 flex-1 flex flex-col">
                            <div className="flex items-center gap-3 mb-3">
                                <div className="relative">
                                    <div className={`absolute inset-0 rounded-xl animate-pulse-ring ${stats.growthRate >= 0 ? 'bg-emerald-500' : 'bg-rose-500'}`}></div>
                                    <div className={`relative z-10 w-8 h-8 rounded-xl border flex items-center justify-center ${stats.growthRate >= 0 ? 'bg-emerald-100 dark:bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-500/20' : 'bg-rose-100 dark:bg-rose-500/10 text-rose-600 dark:text-rose-400 border-rose-200 dark:border-rose-500/20'}`}>
                                        <Icon name="percent" size={18} />
                                    </div>
                                </div>
                                <div className={`${stats.growthRate >= 0 ? 'text-emerald-900/70 dark:text-emerald-200/70' : 'text-rose-900/70 dark:text-rose-200/70'} text-xs font-bold uppercase tracking-widest`}>{t.growthRate}</div>
                            </div>
                            <div className="flex items-baseline gap-1">
                                <span className={`text-3xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg ${
                                    stats.growthRate >= 0 
                                    ? 'text-emerald-700 dark:text-white' 
                                    : 'text-rose-700 dark:text-white'
                                }`}>
                                    {stats.growthRate >= 0 ? '+' : ''}{stats.growthRate.toFixed(1)}
                                </span>
                                <span className={`text-xl font-bold opacity-80 ${stats.growthRate >= 0 ? 'text-emerald-600 dark:text-white/80' : 'text-rose-600 dark:text-white/80'}`}>%</span>
                            </div>
                            <div className={`mt-2 text-xs font-medium ${stats.growthRate >= 0 ? 'text-emerald-700/80 dark:text-emerald-400/80' : 'text-rose-700/80 dark:text-rose-400/80'}`}>
                                {t.vsYesterday}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // 5. Countdown Card
        const CountdownCard = ({ startDate, endDate, symbol, t }) => {
            const [timeLeft, setTimeLeft] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0, status: 'noData', progress: 0 });

            useEffect(() => {
                const calculateTime = () => {
                    const now = new Date();
                    const currentTime = now.getTime();
                    
                    const start = startDate ? new Date(startDate).getTime() : null;
                    const end = endDate ? new Date(endDate).getTime() : null;
                    const currentSeconds = now.getSeconds();

                    if (!start || !end) {
                        setTimeLeft({ days: 0, hours: 0, minutes: 0, seconds: 0, status: 'noData', progress: 0 });
                        return;
                    }

                    let targetDate, status;

                    if (currentTime < start) {
                        targetDate = start;
                        status = 'startsIn';
                    } else if (currentTime >= start && currentTime <= end) {
                        targetDate = end;
                        status = 'endsIn';
                    } else {
                        status = 'ended';
                        setTimeLeft({ days: 0, hours: 0, minutes: 0, seconds: 0, status, progress: 100 });
                        return;
                    }

                    const difference = targetDate - currentTime;
                    const days = Math.floor(difference / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((difference % (1000 * 60)) / 1000); 

                    const secProgress = (currentSeconds / 60) * 100;

                    setTimeLeft({ days, hours, minutes, seconds, status, progress: secProgress });
                };

                calculateTime();
                const timer = setInterval(calculateTime, 1000); 
                return () => clearInterval(timer);
            }, [startDate, endDate]);

            const statusColors = {
                startsIn: 'text-indigo-600 dark:text-indigo-400',
                endsIn: 'text-cyan-600 dark:text-cyan-400',
                ended: 'text-slate-400 dark:text-slate-500',
                noData: 'text-slate-400 dark:text-slate-500'
            };
            
            const pulseColors = {
                startsIn: 'bg-indigo-500',
                endsIn: 'bg-cyan-500',
                ended: 'bg-slate-400',
                noData: 'bg-slate-400'
            };

            const borderGradients = {
                startsIn: 'from-indigo-300 via-purple-400 to-indigo-400',
                endsIn: 'from-cyan-300 via-blue-400 to-indigo-400',
                ended: 'from-slate-200 via-slate-300 to-slate-400 dark:from-slate-700 dark:via-slate-600 dark:to-slate-700',
                noData: 'from-slate-200 via-slate-300 to-slate-400 dark:from-slate-700 dark:via-slate-600 dark:to-slate-700'
            };

            const totalPixels = 40; 
            const activePixels = Math.floor((timeLeft.progress / 100) * totalPixels);

            return (
                <div className={`relative rounded-3xl p-[1px] bg-gradient-to-br ${borderGradients[timeLeft.status]} shadow-sm hover:shadow-xl dark:shadow-lg transition-all duration-300 group h-full`}>
                    <div className="relative overflow-hidden bg-white dark:bg-[#0f101f]/90 active:bg-slate-200 dark:active:bg-slate-950 backdrop-blur-md rounded-[23px] h-full p-4 md:p-6 flex flex-col">
                        {/* Drag Handle */}
                        <div className="absolute top-3 right-3 z-20 opacity-30 group-hover:opacity-100 transition-opacity duration-200 cursor-grab active:cursor-grabbing">
                            <Icon name="grip-horizontal" size={20} className="text-slate-400/50 dark:text-slate-200/30" />
                        </div>

                        <div className={`absolute inset-0 bg-gradient-to-br ${timeLeft.status === 'endsIn' ? 'from-cyan-50/50 dark:from-cyan-900/10' : 'from-indigo-50/50 dark:from-indigo-900/10'} to-transparent opacity-50`}></div>
                        <div className={`absolute -right-4 -top-4 opacity-[0.15] group-hover:opacity-[0.25] transition-all duration-500 transform group-hover:scale-110 group-active:scale-125 group-hover:-rotate-12 group-active:-rotate-12 ${statusColors[timeLeft.status]}`}>
                            <Icon name="timer" size={120} />
                        </div>
                        
                        <div className="relative z-10 flex-1 flex flex-col">
                            <div className="flex items-center gap-3 mb-3">
                                <div className="relative">
                                    <div className={`absolute inset-0 rounded-xl animate-pulse-ring ${pulseColors[timeLeft.status]}`}></div>
                                    <div className={`relative z-10 w-8 h-8 rounded-xl border flex items-center justify-center bg-white/50 dark:bg-white/5 ${statusColors[timeLeft.status]} border-white/20`}>
                                        <Icon name={timeLeft.status === 'ended' ? "flag" : "clock"} size={18} />
                                    </div>
                                </div>
                                <div className="flex flex-col">
                                    <div className={`text-xs font-bold uppercase tracking-widest opacity-70 ${statusColors[timeLeft.status]}`}>{t.cardCountdown}</div>
                                    <div className="text-[10px] font-bold opacity-50">{symbol}</div>
                                </div>
                            </div>
                            
                            {timeLeft.status === 'ended' ? (
                                <div className="text-3xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg text-slate-500 dark:text-slate-400 mb-3">
                                    {t.ended}
                                </div>
                            ) : (
                                <div className={`flex items-baseline gap-1 mb-3 ${statusColors[timeLeft.status]}`}>
                                    <span className="text-3xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg text-slate-900 dark:text-white">{timeLeft.days}</span>
                                    <span className="text-xs font-bold uppercase mr-1">d</span>
                                    <span className="text-3xl font-extrabold tracking-tight drop-shadow-sm dark:drop-shadow-lg text-slate-900 dark:text-white">{timeLeft.hours}</span>
                                    <span className="text-xs font-bold uppercase mr-1">h</span>
                                    <span className="text-3xl font-extrabold tracking-tight drop-shadow-sm opacity-80 text-slate-900 dark:text-white">{timeLeft.minutes}</span>
                                    <span className="text-xs font-bold uppercase mr-1 opacity-80">m</span>
                                </div>
                            )}

                            <div className="mt-auto">
                                {timeLeft.status !== 'ended' && timeLeft.status !== 'noData' && (
                                    <div className="relative">
                                        <div className="flex justify-between text-xs font-medium text-slate-600 dark:text-slate-400 mb-2">
                                            <span>{t[timeLeft.status]}</span>
                                            {/* Modified: Added font-rounded and font-bold to seconds */}
                                            <span className="tabular-nums font-rounded font-bold">{timeLeft.seconds}s</span>
                                        </div>
                                        
                                        <div className="flex justify-between gap-[2px] h-3 w-full">
                                            {[...Array(totalPixels)].map((_, i) => {
                                                const isActive = i < activePixels;
                                                const hue = (i / totalPixels) * 360;
                                                const colorStyle = isActive ? { backgroundColor: `hsl(${hue}, 100%, 60%)`, boxShadow: `0 0 4px hsl(${hue}, 100%, 60%)` } : {};
                                                return <div key={i} className={`h-full flex-1 rounded-sm transition-all duration-300 ${isActive ? 'scale-y-110 opacity-100' : 'bg-slate-200 dark:bg-slate-800/60 opacity-30 scale-y-75'}`} style={colorStyle}></div>;
                                            })}
                                        </div>
                                    </div>
                                )}
                                
                                {timeLeft.status === 'ended' && startDate && endDate && (
                                     <div className="text-[10px] font-mono text-slate-400 border-t border-slate-100 dark:border-slate-800 pt-2">
                                        {new Date(startDate).toLocaleDateString()} - {new Date(endDate).toLocaleDateString()}
                                     </div>
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        
        // --- Pixel Chart Component ---
        const PixelChart = ({ data, t }) => {
            // New state for handling hover
            const [hoveredItem, setHoveredItem] = useState(null);

            if (!data || data.length === 0) return null;

            const maxVol = Math.max(...data.map(d => Math.max(d.volume, d.userVolume || 0))) * 1.2;
            const gridRows = 20; 

            return (
                <div className="w-full h-full flex flex-col items-center justify-end pb-2 pt-8 relative">
                     {/* Fixed Top Tooltip Overlay - Solves clipping issues */}
                     <div className={`absolute top-0 left-0 w-full flex justify-center z-30 pointer-events-none transition-all duration-300 ${hoveredItem ? 'opacity-100 translate-y-0' : 'opacity-0 -translate-y-2'}`}>
                        {hoveredItem && (
                            <div className="bg-slate-900/95 dark:bg-black/90 text-white text-[11px] px-4 py-2 rounded-full backdrop-blur-md border border-white/10 shadow-[0_4px_20px_rgba(0,0,0,0.3)] flex gap-6 items-center">
                                <div className="font-bold text-indigo-300 border-r border-white/20 pr-4">{hoveredItem.displayDay}</div>
                                <div className="flex gap-4">
                                     <div className="flex items-center gap-2">
                                        <span className="text-slate-400 uppercase text-[9px] font-bold tracking-wider">Threshold</span>
                                        <span className="font-mono text-blue-400 font-bold text-sm">${hoveredItem.volume.toLocaleString()}</span>
                                     </div>
                                     <div className="w-[1px] h-4 bg-white/10"></div>
                                     <div className="flex items-center gap-2">
                                        <span className="text-slate-400 uppercase text-[9px] font-bold tracking-wider">You</span>
                                        <span className={`font-mono font-bold text-sm ${hoveredItem.userVolume >= hoveredItem.volume ? 'text-emerald-400' : 'text-rose-400'}`}>
                                            ${hoveredItem.userVolume.toLocaleString()}
                                        </span>
                                     </div>
                                </div>
                            </div>
                        )}
                     </div>

                     <div className="w-full h-[360px] flex items-end justify-between px-2 gap-2 overflow-x-auto custom-scrollbar group/chart relative z-10">
                        {data.map((item, index) => {
                            const thresholdBlocks = Math.ceil((item.volume / maxVol) * gridRows);
                            const userBlocks = Math.ceil((item.userVolume / maxVol) * gridRows);
                            const isSafe = item.userVolume >= item.volume;
                            const isHovered = hoveredItem && hoveredItem.id === item.id;
                            
                            return (
                                <div 
                                    key={index} 
                                    className={`flex flex-col items-center gap-2 group min-w-[40px] transition-all duration-200 cursor-crosshair ${hoveredItem && !isHovered ? 'opacity-30 scale-95' : 'opacity-100 scale-100'}`}
                                    onMouseEnter={() => setHoveredItem(item)}
                                    onMouseLeave={() => setHoveredItem(null)}
                                >
                                    {/* Tooltip Removed from here to prevent clipping */}
                                    <div className="relative flex items-end gap-[2px] h-[300px]">
                                        
                                        {/* Threshold Column (Blue) */}
                                        <div className="flex flex-col-reverse gap-[1px]">
                                            {[...Array(gridRows)].map((_, i) => (
                                                <div 
                                                    key={`t-${i}`} 
                                                    className={`w-3 h-2 rounded-[1px] transition-all duration-300 ${
                                                        i < thresholdBlocks 
                                                        ? 'bg-blue-500/80 shadow-[0_0_5px_rgba(59,130,246,0.3)]' 
                                                        : 'bg-slate-200/20 dark:bg-slate-800/20'
                                                    }`}
                                                ></div>
                                            ))}
                                        </div>

                                        {/* User Column (Dynamic Color) */}
                                        <div className="flex flex-col-reverse gap-[1px]">
                                            {[...Array(gridRows)].map((_, i) => (
                                                <div 
                                                    key={`u-${i}`} 
                                                    className={`w-3 h-2 rounded-[1px] transition-all duration-300 ${
                                                        i < userBlocks 
                                                        ? (isSafe 
                                                            ? 'bg-emerald-500/80 shadow-[0_0_5px_rgba(16,185,129,0.3)]' 
                                                            : 'bg-rose-500/80 shadow-[0_0_5px_rgba(244,63,94,0.3)]')
                                                        : 'bg-slate-200/20 dark:bg-slate-800/20'
                                                    }`}
                                                ></div>
                                            ))}
                                        </div>
                                    </div>
                                    
                                    {/* Axis Label */}
                                    <span className={`text-[9px] font-mono font-bold uppercase transition-colors ${isHovered ? 'text-indigo-500 dark:text-indigo-400 scale-110' : 'text-slate-400 dark:text-slate-600'}`}>
                                        {item.displayDay.split(' ')[1]}
                                    </span>
                                </div>
                            );
                        })}
                     </div>
                     
                     {/* Legend */}
                     <div className="flex gap-4 mt-4 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest bg-slate-100/50 dark:bg-slate-800/50 px-4 py-2 rounded-full border border-slate-200 dark:border-slate-700/50">
                        <div className="flex items-center gap-1.5">
                            <div className="w-2 h-2 bg-blue-500 rounded-[1px] shadow-[0_0_5px_rgba(59,130,246,0.5)]"></div> Threshold
                        </div>
                        <div className="flex items-center gap-1.5">
                            <div className="w-2 h-2 bg-emerald-500 rounded-[1px] shadow-[0_0_5px_rgba(16,185,129,0.5)]"></div> Safe
                        </div>
                        <div className="flex items-center gap-1.5">
                            <div className="w-2 h-2 bg-rose-500 rounded-[1px] shadow-[0_0_5px_rgba(244,63,94,0.5)]"></div> Risk
                        </div>
                     </div>
                </div>
            );
        };


        // Default Competition Config
        const defaultCompetitions = [
            { 
                id: 'night', 
                name: 'Midnight', 
                symbol: 'NIGHT', 
                coingeckoId: 'midnight-3', 
                color: 'indigo', 
                icon: 'moon', 
                gradient: 'from-indigo-500 to-purple-600', 
                startDate: new Date().toISOString().split('T')[0], 
                endDate: new Date(Date.now() + 86400000 * 7).toISOString().split('T')[0] 
            },
            { 
                id: 'btc', 
                name: 'Bitcoin', 
                symbol: 'BTC', 
                coingeckoId: 'bitcoin', 
                color: 'orange', 
                icon: 'bitcoin', 
                gradient: 'from-orange-500 to-amber-500',
                startDate: new Date(Date.now() + 86400000 * 2).toISOString().split('T')[0], 
                endDate: new Date(Date.now() + 86400000 * 16).toISOString().split('T')[0] 
            },
            { 
                id: 'eth', 
                name: 'Ethereum', 
                symbol: 'ETH', 
                coingeckoId: 'ethereum', 
                color: 'blue', 
                icon: 'zap', 
                gradient: 'from-blue-500 to-cyan-500',
                startDate: new Date(Date.now() - 86400000 * 3).toISOString().split('T')[0], 
                endDate: new Date(Date.now() + 86400000 * 11).toISOString().split('T')[0] 
            },
            { 
                id: 'sol', 
                name: 'Solana', 
                symbol: 'SOL', 
                coingeckoId: 'solana', 
                color: 'emerald', 
                icon: 'layers', 
                gradient: 'from-emerald-400 to-teal-500',
                startDate: new Date(Date.now() + 86400000 * 5).toISOString().split('T')[0], 
                endDate: new Date(Date.now() + 86400000 * 12).toISOString().split('T')[0] 
            }
        ];

        // Color Options
        const colorOptions = [
            { id: 'indigo', label: 'Indigo', gradient: 'from-indigo-500 to-purple-600', icon: 'moon' },
            { id: 'orange', label: 'Orange', gradient: 'from-orange-500 to-amber-500', icon: 'bitcoin' },
            { id: 'blue', label: 'Blue', gradient: 'from-blue-500 to-cyan-500', icon: 'zap' },
            { id: 'emerald', label: 'Emerald', gradient: 'from-emerald-400 to-teal-500', icon: 'layers' },
            { id: 'rose', label: 'Rose', gradient: 'from-rose-500 to-pink-600', icon: 'flame' },
            { id: 'violet', label: 'Violet', gradient: 'from-violet-500 to-fuchsia-600', icon: 'gem' },
        ];

        // Default Initial Data
        const initialDataMap = {
            night: [
                { id: 'init-1', volume: 36129.54, userVolume: 42000.00, timestamp: new Date(Date.now() - 172800000).toISOString(), source: 'default', reward: 1700, eligibility: 20500 },
                { id: 'init-2', volume: 60689.17, userVolume: 58000.00, timestamp: new Date(Date.now() - 86400000).toISOString(), source: 'default', reward: 1700, eligibility: 20500 },
            ],
        };

        // Translations
        const translations = {
            zh: {
                subtitle: "数据驱动的交易赛入榜门槛预测系统",
                manualEntry: "手动补录",
                importScreenshot: "截图识别",
                analyzing: "AI 识别中...",
                currentThreshold: "当前入榜门槛",
                liveUpdate: "实时更新",
                growthRate: "24H 变动",
                vsYesterday: "较昨日同期",
                predictedNext: "明日预测目标",
                linearTrend: "基于线性趋势",
                rewardEst: "单号奖励估值 (USD)",
                rewardNote: "(按实时币价)",
                historySnapshot: "历史快照",
                growthCurve: "门槛 vs 个人交易量趋势",
                aiAnalysis: "AI 深度策略预测",
                aiAnalyzing: "AI 分析中...",
                manualModalTitle: "手动录入",
                dateLabel: "日期",
                volumeLabel: "入榜门槛交易量 (USD)",
                userVolumeLabel: "您的交易量 (USD) - 可选",
                rewardLabel: "奖励数量 - 可选",
                eligibilityLabel: "合格名次 (如 20500)",
                confirmButton: "确认录入",
                aiPhase: "阶段",
                aiRisk: "风险评级",
                geminiInsight: "Gemini 赛项深度洞察",
                day: "Day",
                priceLive: "LIVE",
                priceEst: "EST",
                sourceAI: "AI",
                sourceMan: "人工",
                delete: "删除",
                edit: "编辑",
                errorTrend: "需要至少两条历史数据进行趋势预测",
                errorRecognize: "AI 未能识别内容",
                errorValid: "识别结果不是有效数字",
                promptStrategy: "你是一个专业的交易比赛分析师。请用中文回答。分析当前市场竞争阶段（如：早期积累、中期拉升、冲刺阶段）和风险等级（低、中、高）。并给出针对性的冲榜策略建议（简短有力，100字以内）。根据以下历史入榜门槛数据序列：",
                switchCompetition: "切换交易赛",
                selectCompetition: "选择要分析的币种赛道",
                addCompetition: "添加新赛道",
                editCompetition: "编辑赛道",
                compName: "币种名称 (如 Bitcoin)",
                compSymbol: "代币符号 (如 BTC)",
                compCgId: "CoinGecko ID (用于价格)",
                compColor: "主题颜色",
                save: "保存配置",
                cancel: "取消",
                deleteConfirmTitle: "确认删除",
                deleteConfirmDesc: "确定要删除这个赛道吗？所有相关的历史数据都将永久丢失且无法恢复。",
                confirmDelete: "确认删除",
                cgIdHint: "在 coingecko.com 网址中找到，例如 'bitcoin'",
                gap: "差距",
                statusSafe: "安全",
                statusRisk: "危险",
                legendThreshold: "入榜门槛",
                legendUser: "您的交易量",
                statusTitle: "当前状态",
                lead: "领先门槛",
                lag: "落后门槛",
                themeLight: "亮色",
                themeDark: "暗色",
                settings: "设置",
                apiKeyLabel: "Gemini API Keys (支持多Key轮询)",
                apiKeyPlaceholder: "在此粘贴 API Key",
                saveKey: "保存设置",
                clearKey: "清除所有",
                apiKeyHint: "系统会自动使用第一个可用的 API Key。如果主 Key 失效，会自动切换到备用 Key。Key 仅保存在本地。",
                errorApiKey: "未检测到有效的 API Key。请在设置中输入您的 Gemini API Key 以使用 AI 功能。",
                cardCountdown: "比赛倒计时",
                startsIn: "距离开始",
                endsIn: "距离结束",
                ended: "已结束",
                periodLabel: "比赛周期 (官方 UTC+8 标准)",
                startLabel: "开始时间",
                endLabel: "结束时间",
                subCardReward: "单号代币",
                subCardRank: "入围名次",
                hourLabel: "时",
                minuteLabel: "分",
                key1Label: "主 API Key",
                key2Label: "备用 Key 1",
                key3Label: "备用 Key 2",
                developer: "开发者",
                about: "关于",
                donation: "捐赠",
                aboutTitle: "关于 AlphaDash",
                aboutDesc: "AlphaDash 是一个专为交易赛设计的辅助分析工具，旨在帮助用户追踪排名门槛、分析数据趋势并制定冲榜策略。本工具完全运行在本地浏览器中，您的 API Key 和数据均存储在本地 LocalStorage，不会上传至任何服务器。",
                donationTitle: "支持开发者",
                donationDesc: "如果您觉得这个工具对您有帮助，欢迎打赏支持后续开发！",
                copy: "复制",
                copied: "已复制",
                followX: "关注 X",
                version: "版本 v6.3",
                dataMgmt: "数据管理 (Data Management)",
                exportData: "导出备份 (Export JSON)",
                importData: "导入恢复 (Import JSON)",
                importConfirm: "确定要导入数据吗？这将覆盖当前的赛道配置和历史记录。",
                importSuccess: "数据恢复成功！"
            },
            en: {
                subtitle: "Data-driven Competition Threshold Prediction System",
                manualEntry: "Entry",
                importScreenshot: "Scan",
                analyzing: "Scanning...",
                currentThreshold: "Current Threshold",
                liveUpdate: "Live Update",
                growthRate: "24H Change",
                vsYesterday: "vs Yesterday",
                predictedNext: "Next Day Target",
                linearTrend: "Linear Trend Based",
                rewardEst: "Est. Reward Value (USD)",
                rewardNote: "(Live Price)",
                historySnapshot: "History Snapshots",
                growthCurve: "Threshold vs User Volume",
                aiAnalysis: "AI Strategy Insight",
                aiAnalyzing: "Analyzing...",
                manualModalTitle: "Manual Entry",
                dateLabel: "Date",
                volumeLabel: "Threshold Volume (USD)",
                userVolumeLabel: "Your Volume (USD) - Optional",
                rewardLabel: "Reward Amount - Optional",
                eligibilityLabel: "Eligibility Rank (e.g. 20500)",
                confirmButton: "Confirm Entry",
                aiPhase: "Phase",
                aiRisk: "Risk Level",
                geminiInsight: "Gemini Competition Insight",
                day: "Day",
                priceLive: "LIVE",
                priceEst: "EST",
                sourceAI: "AI",
                sourceMan: "MANUAL",
                delete: "Delete",
                edit: "Edit",
                errorTrend: "Need at least 2 data points for prediction",
                errorRecognize: "AI failed to recognize content",
                errorValid: "Result is not a valid number",
                promptStrategy: "You are a professional trading competition analyst. Please respond in English. Analyze current market phase (e.g. Accumulation, Surge, Final Sprint) and Risk Level (Low, Medium, High). Give specific strategy advice (short and concise, under 100 words). Based on the following historical threshold data sequence:",
                switchCompetition: "Switch Competition",
                selectCompetition: "Select Competition Track",
                addCompetition: "Add New Track",
                editCompetition: "Edit Track",
                compName: "Coin Name (e.g. Bitcoin)",
                compSymbol: "Token Symbol (e.g. BTC)",
                compCgId: "CoinGecko ID (for price)",
                compColor: "Theme Color",
                save: "Save Configuration",
                cancel: "Cancel",
                deleteConfirmTitle: "Confirm Deletion",
                deleteConfirmDesc: "Are you sure you want to delete this track? All historical data associated with it will be permanently lost.",
                confirmDelete: "Delete Track",
                cgIdHint: "Find in coingecko.com URL, e.g. 'bitcoin'",
                gap: "Gap",
                statusSafe: "Safe",
                statusRisk: "Risk",
                legendThreshold: "Threshold",
                legendUser: "Your Volume",
                statusTitle: "Current Status",
                lead: "Leading Threshold",
                lag: "Trailing Threshold",
                themeLight: "Light",
                themeDark: "Dark",
                settings: "Settings",
                apiKeyLabel: "Gemini API Keys (Multi-key Failover)",
                apiKeyPlaceholder: "Paste API Key here",
                saveKey: "Save Settings",
                clearKey: "Clear All",
                apiKeyHint: "System automatically uses the first available key and switches to backup keys if quota is exceeded.",
                errorApiKey: "No valid API Key found. Please enter at least one Gemini API Key in Settings.",
                cardCountdown: "Time Remaining",
                startsIn: "Starts In",
                endsIn: "Ends In",
                ended: "Ended",
                periodLabel: "Competition Period (UTC+8 Standard)",
                startLabel: "Start Date",
                endLabel: "End Date",
                subCardReward: "Tokens/User",
                subCardRank: "Rank Limit",
                hourLabel: "Hr",
                minuteLabel: "Min",
                key1Label: "Primary Key",
                key2Label: "Backup Key 1",
                key3Label: "Backup Key 2",
                developer: "Developer",
                about: "About",
                donation: "Donate",
                aboutTitle: "About AlphaDash",
                aboutDesc: "AlphaDash is an analytical tool designed for trading competitions, helping users track threshold volumes, analyze trends, and formulate strategies. This tool runs entirely in your local browser. Your API Keys and data are stored locally in LocalStorage and are never uploaded to any server.",
                donationTitle: "Support Development",
                donationDesc: "If you find this tool helpful, please consider donating to support future development!",
                copy: "Copy",
                copied: "Copied",
                followX: "Follow X",
                version: "Version v6.3",
                dataMgmt: "Data Management",
                exportData: "Export Backup (JSON)",
                importData: "Import Backup (JSON)",
                importConfirm: "Are you sure you want to import data? This will overwrite current tracks and history.",
                importSuccess: "Data restored successfully!"
            }
        };

        const App = () => {
            const [lang, setLang] = useState('zh');
            const [theme, setTheme] = useState('dark'); 
            const t = translations[lang];

            const [cardOrder, setCardOrder] = useState(() => {
                const savedOrder = localStorage.getItem('card_order');
                return savedOrder ? JSON.parse(savedOrder) : ['reward', 'countdown', 'prediction', 'threshold', 'growth'];
            });
            const [draggedItem, setDraggedItem] = useState(null);

            useEffect(() => {
                const root = window.document.documentElement;
                const metaThemeColor = document.querySelector("meta[name=theme-color]");
                
                if (theme === 'dark') {
                    root.classList.add('dark');
                    document.body.classList.add('dark');
                    if(metaThemeColor) metaThemeColor.setAttribute("content", "#000000");
                } else {
                    root.classList.remove('dark');
                    document.body.classList.remove('dark');
                    if(metaThemeColor) metaThemeColor.setAttribute("content", "#f8fafc");
                }
            }, [theme]);

            const [competitions, setCompetitions] = useState(() => {
                const saved = localStorage.getItem('night_competitions');
                return saved ? JSON.parse(saved) : defaultCompetitions;
            });

            useEffect(() => {
                localStorage.setItem('night_competitions', JSON.stringify(competitions));
            }, [competitions]);

            const [currentComp, setCurrentComp] = useState(competitions[0]);
            const [dataList, setDataList] = useState(() => {
                const savedData = localStorage.getItem(`night_data_${defaultCompetitions[0].id}`);
                return savedData ? JSON.parse(savedData) : initialDataMap[defaultCompetitions[0].id];
            });

            const [showCompModal, setShowCompModal] = useState(false);
            const [isAnalyzing, setIsAnalyzing] = useState(false);
            const [isGeneratingStrategy, setIsGeneratingStrategy] = useState(false);
            const [showManualModal, setShowManualModal] = useState(false);
            const [aiStrategy, setAiStrategy] = useState(null);
            const [error, setError] = useState(null);
            
            // Manual Entry State
            const [manualVolume, setManualVolume] = useState('');
            const [manualUserVolume, setManualUserVolume] = useState('');
            const [manualReward, setManualReward] = useState('');
            const [manualEligibility, setManualEligibility] = useState('');
            const [manualDate, setManualDate] = useState(new Date().toISOString().split('T')[0]);
            
            // Time states for UTC+8 handling
            const [manualStartDate, setManualStartDate] = useState('');
            const [manualStartHour, setManualStartHour] = useState('00');
            const [manualStartMinute, setManualStartMinute] = useState('00');
            const [manualEndDate, setManualEndDate] = useState('');
            const [manualEndHour, setManualEndHour] = useState('00');
            const [manualEndMinute, setManualEndMinute] = useState('00');

            const [showManageModal, setShowManageModal] = useState(false);
            const [editingComp, setEditingComp] = useState(null);
            const [compForm, setCompForm] = useState({ name: '', symbol: '', coingeckoId: '', color: 'indigo' });

            const [showDeleteModal, setShowDeleteModal] = useState(false);
            const [deleteTargetId, setDeleteTargetId] = useState(null);

            const [showSettingsModal, setShowSettingsModal] = useState(false);
            
            // New Modals State
            const [showAboutModal, setShowAboutModal] = useState(false);
            const [showDonationModal, setShowDonationModal] = useState(false);
            
            // View Mode State
            const [chartViewMode, setChartViewMode] = useState('curve'); // 'curve' or 'pixel'
            const [isAICollapsed, setIsAICollapsed] = useState(false);
            
            // Donation State
            const [donateTab, setDonateTab] = useState('bsc'); // 'bsc' or 'sol'
            
            const donationAddresses = {
                bsc: "0xd99fe03da62cc568decaf4d5d97625f179652840",
                sol: "Esp38U7W4D1khAGKPQLvmLqdRU39GhcSyGgaeZvnwTpL"
            };
            const currentAddress = donationAddresses[donateTab];

            // Multi-Key State Management
            const [apiKeys, setApiKeys] = useState(() => {
                const savedKeys = localStorage.getItem('gemini_api_keys');
                if (savedKeys) {
                    try {
                        return JSON.parse(savedKeys);
                    } catch (e) {
                        return ['', '', ''];
                    }
                }
                const legacyKey = localStorage.getItem('gemini_api_key');
                return legacyKey ? [legacyKey, '', ''] : ['', '', ''];
            });
            const [tempKeys, setTempKeys] = useState(['', '', '']); 

            const [coinPrice, setCoinPrice] = useState(0); 
            const [isLivePrice, setIsLivePrice] = useState(false);

            useEffect(() => {
                const savedData = localStorage.getItem(`night_data_${currentComp.id}`);
                if (savedData) {
                    setDataList(JSON.parse(savedData));
                } else {
                    setDataList(initialDataMap[currentComp.id] || []);
                }
                setAiStrategy(null);
                setError(null);
                setCoinPrice(0);
                setIsLivePrice(false);
            }, [currentComp.id]); 
            
            const parseISOToUTC8 = (isoString) => {
                if (!isoString) return { date: '', hour: '00', minute: '00' };
                const date = new Date(isoString);
                if (isNaN(date.getTime())) return { date: '', hour: '00', minute: '00' };
                const utc8Date = new Date(date.getTime() + 28800000);
                const iso = utc8Date.toISOString(); 
                const [d, tPart] = iso.split('T');
                const [h, m] = tPart.split(':');
                return { date: d, hour: h, minute: m };
            };

            useEffect(() => {
                const startData = parseISOToUTC8(currentComp.startDate);
                setManualStartDate(startData.date);
                setManualStartHour(startData.hour);
                setManualStartMinute(startData.minute);
                
                const endData = parseISOToUTC8(currentComp.endDate);
                setManualEndDate(endData.date);
                setManualEndHour(endData.hour);
                setManualEndMinute(endData.minute);
            }, [currentComp]);

            const persistData = (newData) => {
                setDataList(newData);
                localStorage.setItem(`night_data_${currentComp.id}`, JSON.stringify(newData));
            };

            useEffect(() => {
                let isMounted = true;
                const fetchPrice = async () => {
                    if (!currentComp.coingeckoId) return;
                    try {
                        const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${currentComp.coingeckoId}&vs_currencies=usd`);
                        if (response.ok) {
                            const data = await response.json();
                            // 检查 API 是否真的返回了该 ID 的数据
                            if (isMounted && data[currentComp.coingeckoId] && data[currentComp.coingeckoId].usd) {
                                setCoinPrice(data[currentComp.coingeckoId].usd);
                                setIsLivePrice(true);
                            } else {
                                // API 返回 200 但没有数据 (可能是 ID 错误或新币无价格) -> 抛出错误以触发 Fallback
                                throw new Error("No price data found");
                            }
                        } else {
                            if (isMounted) setIsLivePrice(false);
                            throw new Error("API Limit");
                        }
                    } catch (e) {
                        if (isMounted) {
                            // Fallback 机制：如果获取失败或无数据，生成微小的随机波动，保持界面活跃
                            setCoinPrice(prev => {
                                if (prev === 0) return 0.0001; // 初始基准价
                                const change = prev * (Math.random() * 0.01 - 0.005); // +/- 0.5% 波动
                                return Math.max(0.00000001, prev + change);
                            });
                            setIsLivePrice(false); // 标记为 EST (估算/模拟)
                        }
                    }
                };
                fetchPrice();
                const interval = setInterval(fetchPrice, 15000);
                return () => { isMounted = false; clearInterval(interval); };
            }, [currentComp.coingeckoId]);

            const chartData = useMemo(() => {
                return [...dataList]
                    .sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp))
                    .map((item, index) => ({
                        ...item,
                        displayDay: `${t.day} ${index + 1}`,
                        userVolume: item.userVolume || 0
                    }));
            }, [dataList, t.day]);

            const stats = useMemo(() => {
                if (chartData.length < 1) return { current: 0, growthRate: 0, predictedNext: 0, maxVolume: 0, latestReward: 0, latestUserVolume: 0, latestEligibility: 0 };
                const current = chartData[chartData.length - 1].volume;
                const previous = chartData[chartData.length - 2]?.volume || current;
                const growthRate = previous === 0 ? 0 : ((current - previous) / previous) * 100;
                
                const maxVolume = Math.max(...chartData.map(d => d.volume));
                
                const reversedData = [...chartData].reverse();
                const latestRewardItem = reversedData.find(item => item.reward !== undefined && item.reward !== null && !isNaN(item.reward));
                const latestReward = latestRewardItem ? latestRewardItem.reward : 0;

                const latestEligibilityItem = reversedData.find(item => item.eligibility !== undefined && item.eligibility !== null);
                const latestEligibility = latestEligibilityItem ? latestEligibilityItem.eligibility : 0;
                
                const latestUserVolume = chartData[chartData.length - 1]?.userVolume || 0;

                return { current, growthRate, predictedNext: current * (1 + (growthRate / 100)), maxVolume, latestReward, latestUserVolume, latestEligibility };
            }, [chartData]);

            // --- Drag Logic (Live Sorting) ---
            const handleDragStart = (e, index) => {
                setDraggedItem(index);
                e.dataTransfer.effectAllowed = 'move';
                // Ghost image fix (optional, browser handles it well usually)
                // e.dataTransfer.setDragImage(e.target, 0, 0);
            };

            const handleDragOver = (e) => {
                e.preventDefault(); // Necessary to allow dropping
            };

            const handleDragEnter = (e, targetIndex) => {
                // This implements the "Live Sort" visual feedback
                if (draggedItem === null) return;
                if (draggedItem === targetIndex) return;

                const newOrder = [...cardOrder];
                const draggedCardType = newOrder[draggedItem];

                // Remove the dragged item from its old position
                newOrder.splice(draggedItem, 1);
                // Insert it at the new target position
                newOrder.splice(targetIndex, 0, draggedCardType);

                setCardOrder(newOrder);
                setDraggedItem(targetIndex); // Update dragged index to follow the item
            };

            const handleDrop = (e) => {
                e.preventDefault();
                // The state is already updated by handleDragEnter, so we just persist it
                localStorage.setItem('card_order', JSON.stringify(cardOrder));
                setDraggedItem(null);
            };

            const handleDragEnd = () => {
                setDraggedItem(null);
            };

            // --- Import / Export Logic ---
            const handleExportData = () => {
                const dataToExport = {
                    competitions: competitions,
                    apiKeys: apiKeys,
                    // Export data for ALL competitions, not just the current one
                    dataLists: competitions.reduce((acc, comp) => {
                        const compData = localStorage.getItem(`night_data_${comp.id}`);
                        if (compData) {
                            acc[comp.id] = JSON.parse(compData);
                        }
                        return acc;
                    }, {})
                };

                const dataStr = JSON.stringify(dataToExport, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `AlphaDash_Backup_${new Date().toISOString().split('T')[0]}.json`;

                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            };

            const handleImportData = (event) => {
                const fileReader = new FileReader();
                const file = event.target.files[0];

                if (!file) return;

                if (window.confirm(t.importConfirm)) {
                    fileReader.readAsText(file, "UTF-8");
                    fileReader.onload = e => {
                        try {
                            const importedData = JSON.parse(e.target.result);
                            
                            // Restore Competitions
                            if (importedData.competitions) {
                                setCompetitions(importedData.competitions);
                                localStorage.setItem('night_competitions', JSON.stringify(importedData.competitions));
                            }

                            // Restore API Keys (if present)
                            if (importedData.apiKeys) {
                                setApiKeys(importedData.apiKeys);
                                localStorage.setItem('gemini_api_keys', JSON.stringify(importedData.apiKeys));
                            }

                            // Restore Data Lists
                            if (importedData.dataLists) {
                                Object.keys(importedData.dataLists).forEach(compId => {
                                    localStorage.setItem(`night_data_${compId}`, JSON.stringify(importedData.dataLists[compId]));
                                });
                                // Force refresh current list if applicable
                                if (importedData.dataLists[currentComp.id]) {
                                    setDataList(importedData.dataLists[currentComp.id]);
                                }
                            }
                            
                            alert(t.importSuccess);
                            setShowSettingsModal(false);
                        } catch (err) {
                            setError("Import Failed: Invalid JSON file.");
                        }
                    };
                }
                event.target.value = null; // Reset input
            };

            // Card Rendering
            const renderCard = (type) => {
                switch(type) {
                    case 'reward':
                        return <RewardCard stats={stats} coinPrice={coinPrice} currentComp={currentComp} t={t} />;
                    case 'countdown':
                        return <CountdownCard startDate={currentComp.startDate} endDate={currentComp.endDate} symbol={currentComp.symbol} t={t} />;
                    case 'prediction':
                        return <PredictionCard stats={stats} t={t} />;
                    case 'threshold':
                        return <ThresholdCard stats={stats} t={t} />;
                    case 'growth':
                        return <GrowthCard stats={stats} t={t} />;
                    default:
                        return null;
                }
            };

            // --- Helpers ---
            const handleOpenManualEntry = () => {
                setManualReward(stats.latestReward || '');
                setManualEligibility(stats.latestEligibility || '');
                setManualVolume('');
                setManualUserVolume('');
                setManualDate(new Date().toISOString().split('T')[0]);
                
                // FIX: Do not reset to empty. Instead, load existing competition dates.
                const startData = parseISOToUTC8(currentComp.startDate);
                setManualStartDate(startData.date);
                setManualStartHour(startData.hour);
                setManualStartMinute(startData.minute);
                
                const endData = parseISOToUTC8(currentComp.endDate);
                setManualEndDate(endData.date);
                setManualEndHour(endData.hour);
                setManualEndMinute(endData.minute);
                
                setShowManualModal(true);
            };

            const openManageModal = (comp = null) => {
                if (comp) {
                    setEditingComp(comp);
                    const startData = parseISOToUTC8(comp.startDate);
                    const endData = parseISOToUTC8(comp.endDate);
                    
                    setCompForm({ 
                        name: comp.name, 
                        symbol: comp.symbol, 
                        coingeckoId: comp.coingeckoId, 
                        color: comp.color,
                        startDate: startData.date,
                        startHour: startData.hour,
                        startMinute: startData.minute,
                        endDate: endData.date,
                        endHour: endData.hour,
                        endMinute: endData.minute
                    });
                } else {
                    setEditingComp(null);
                    setCompForm({ 
                        name: '', symbol: '', coingeckoId: '', color: 'indigo', 
                        startDate: '', startHour: '00', startMinute: '00',
                        endDate: '', endHour: '00', endMinute: '00'
                    });
                }
                setShowManageModal(true);
            };

            const handleSaveCompetition = () => {
                if (!compForm.name || !compForm.symbol) return;
                const selectedColor = colorOptions.find(c => c.id === compForm.color);
                
                const constructDate = (d, h, m) => {
                    if (!d) return null;
                    // Construct ISO string assuming input is UTC+8
                    const isoLocal = `${d}T${h}:${m}:00+08:00`;
                    return new Date(isoLocal).toISOString();
                };

                const newComp = {
                    id: editingComp ? editingComp.id : `custom-${Date.now()}`,
                    name: compForm.name,
                    symbol: compForm.symbol,
                    coingeckoId: compForm.coingeckoId,
                    color: compForm.color,
                    icon: selectedColor.icon,
                    gradient: selectedColor.gradient,
                    startDate: compForm.startDate ? constructDate(compForm.startDate, compForm.startHour, compForm.startMinute) : (editingComp ? editingComp.startDate : null),
                    endDate: compForm.endDate ? constructDate(compForm.endDate, compForm.endHour, compForm.endMinute) : (editingComp ? editingComp.endDate : null)
                };

                if (editingComp) {
                    setCompetitions(prev => prev.map(c => c.id === editingComp.id ? newComp : c));
                    if (currentComp.id === editingComp.id) setCurrentComp(newComp);
                } else {
                    setCompetitions(prev => [...prev, newComp]);
                }
                setShowManageModal(false);
            };

            const handleDeleteRequest = (id, e) => {
                e.stopPropagation();
                setDeleteTargetId(id);
                setShowDeleteModal(true);
            };

            const confirmDeleteCompetition = () => {
                if (!deleteTargetId) return;
                const newComps = competitions.filter(c => c.id !== deleteTargetId);
                setCompetitions(newComps);
                localStorage.removeItem(`night_data_${deleteTargetId}`);
                if (currentComp.id === deleteTargetId && newComps.length > 0) {
                    setCurrentComp(newComps[0]);
                }
                setShowDeleteModal(false);
                setDeleteTargetId(null);
            };

            const confirmSaveKey = () => {
                setApiKeys(tempKeys);
                localStorage.setItem('gemini_api_keys', JSON.stringify(tempKeys));
                localStorage.removeItem('gemini_api_key');
                setShowSettingsModal(false);
                setError(null);
            };

            const clearKey = () => {
                setTempKeys(['', '', '']);
            };
            
            const openSettingsModal = () => {
                setTempKeys(apiKeys);
                setShowSettingsModal(true);
            };

            const fetchWithRetry = async (url, options, retryCount = 0) => {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) {
                        const errBody = await response.json().catch(() => ({}));
                        throw new Error(errBody.error?.message || `HTTP ${response.status}`);
                    }
                    return await response.json();
                } catch (err) {
                    if (err.message.includes('400') || err.message.includes('403') || err.message.includes('API key')) {
                         throw err; 
                    }
                    if (retryCount < 5) {
                        const delay = Math.pow(2, retryCount) * 1000;
                        await new Promise(r => setTimeout(r, delay));
                        return fetchWithRetry(url, options, retryCount + 1);
                    }
                    throw err;
                }
            };
            
            const callGeminiAPI = async (payload) => {
                const validKeys = apiKeys.filter(k => k && k.trim() !== '');
                if (validKeys.length === 0) throw new Error(t.errorApiKey);

                let lastError = null;
                for (const key of validKeys) {
                    try {
                        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${key}`;
                        return await fetchWithRetry(url, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                    } catch (error) {
                        console.warn("API Key failed, trying next...", error);
                        lastError = error;
                    }
                }
                throw lastError || new Error("All API keys failed.");
            };

            const handleFileUpload = async (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const hasKeys = apiKeys.some(k => k && k.trim() !== '');
                if (!hasKeys) {
                    setError(t.errorApiKey);
                    openSettingsModal();
                    event.target.value = null;
                    return;
                }

                setIsAnalyzing(true);
                setError(null);

                try {
                    const base64 = await new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => resolve(reader.result.split(',')[1]);
                        reader.onerror = reject;
                        reader.readAsDataURL(file);
                    });

                    const promptText = `
                        Please analyze this trading competition leaderboard screenshot and extract:
                        1. "volume": Minimum threshold volume (last place on list).
                        2. "reward": Reward amount per user (optional, null if not found).
                        3. "userVolume": My/User's personal trading volume if visible (look for 'My Volume', 'Personal', 'Your Volume'). Return null if not found.
                        4. "dataCutoff": The "Data cutoff time" or "Last Updated" timestamp visible in the image. Please format it as a standard ISO string or complete date string.
                        5. "eligibility": The rank limit or number of winners (e.g. "Top 2000", "1-500"). Return the maximum rank number (e.g. 2000).
                        6. "promotionPeriod": Extract start and end dates from text like "Promotion Period: 2023-10-01 to 2023-10-30" or "Ends in X days". Format as ISO date strings (YYYY-MM-DD). If "Ends in" is found, calculate end date from now.
                        
                        Strictly return JSON string: { "volume": 123.45, "reward": 100, "userVolume": 200.5, "dataCutoff": "2023-10-25T14:30:00", "eligibility": 2000, "promotionStart": "2023-10-01", "promotionEnd": "2023-10-30" }
                    `;

                    const result = await callGeminiAPI({
                        contents: [{
                            parts: [
                                { text: promptText },
                                { inlineData: { mimeType: file.type, data: base64 } }
                            ]
                        }]
                    });

                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (!text) throw new Error(t.errorRecognize);

                    const jsonStr = text.replace(/```json/g, '').replace(/```/g, '').trim();
                    
                    let parsedData;
                    try {
                        const firstBrace = jsonStr.indexOf('{');
                        const lastBrace = jsonStr.lastIndexOf('}');
                        if (firstBrace !== -1 && lastBrace !== -1) {
                            parsedData = JSON.parse(jsonStr.substring(firstBrace, lastBrace + 1));
                        } else {
                            throw new Error("No JSON found");
                        }
                    } catch (e) {
                         const val = parseFloat(text.trim().replace(/[^0-9.]/g, ''));
                         parsedData = { volume: val, reward: null, userVolume: null };
                    }

                    if (parsedData) {
                        if (parsedData.promotionStart || parsedData.promotionEnd) {
                            const updatedComp = { 
                                ...currentComp, 
                                startDate: parsedData.promotionStart || currentComp.startDate,
                                endDate: parsedData.promotionEnd || currentComp.endDate
                            };
                            setCompetitions(prev => prev.map(c => c.id === currentComp.id ? updatedComp : c));
                            setCurrentComp(updatedComp);
                        }

                        if (!isNaN(parsedData.volume) && parsedData.volume > 0) {
                            let timestamp = new Date().toISOString();
                            if (parsedData.dataCutoff) {
                                const parsedTime = new Date(parsedData.dataCutoff);
                                if (!isNaN(parsedTime.getTime())) {
                                    timestamp = parsedTime.toISOString();
                                }
                            }

                            const newData = [...dataList, { 
                                id: Date.now(), 
                                volume: parsedData.volume, 
                                userVolume: parsedData.userVolume || 0,
                                reward: parsedData.reward || (stats.latestReward || 0), 
                                eligibility: parsedData.eligibility || (stats.latestEligibility || 0),
                                timestamp: timestamp, 
                                source: 'ai' 
                            }];
                            persistData(newData);
                        }
                    } else {
                        throw new Error(t.errorValid);
                    }
                } catch (e) {
                    setError(e.message);
                } finally {
                    setIsAnalyzing(false);
                    event.target.value = null;
                }
            };

            const generateAIStrategy = async () => {
                if (chartData.length < 2) {
                    setError(t.errorTrend);
                    return;
                }
                
                const hasKeys = apiKeys.some(k => k && k.trim() !== '');
                if (!hasKeys) {
                    setError(t.errorApiKey);
                    openSettingsModal();
                    return;
                }

                setIsGeneratingStrategy(true);
                setError(null);
                try {
                    const dataStr = chartData.map(d => `${d.displayDay}: Threshold $${d.volume}, My Volume $${d.userVolume}`).join(', ');
                    
                    const prompt = `
                        You are an experienced trading competition coach with 10 years of experience. Please analyze the following data and provide comprehensive advice. Respond in ${lang === 'zh' ? 'Chinese' : 'English'}.

                        [Competition Data]
                        Coin: ${currentComp.name} (${currentComp.symbol})
                        Historical Thresholds: ${dataStr}
                        My Volume: $${stats.latestUserVolume}
                        Current Threshold: $${stats.current}
                        Predicted Next Threshold: $${stats.predictedNext}

                        [Requirements]
                        Return a strict JSON object (no Markdown) with these fields:
                        1. "marketPhase" (string): Define the current phase (e.g. Accumulation, Surge, Final Sprint).
                        2. "riskLevel" (string): Assessment of risk (Low/Medium/High).
                        3. "analysis" (string): Deep dive analysis (under 100 words).
                        4. "actionableAdvice" (array of strings): 3 specific tactical advices. Calculate specific USD targets.
                        5. "psychologicalTip" (string): A short mindset tip.
                    `;

                    const result = await callGeminiAPI({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: { 
                            responseMimeType: "application/json",
                            responseSchema: {
                                type: "object",
                                properties: {
                                    marketPhase: { type: "string" },
                                    riskLevel: { type: "string" },
                                    analysis: { type: "string" },
                                    actionableAdvice: { 
                                        type: "array",
                                        items: { type: "string" }
                                    },
                                    psychologicalTip: { type: "string" }
                                },
                                required: ["marketPhase", "riskLevel", "analysis", "actionableAdvice", "psychologicalTip"]
                            }
                        }
                    });

                    const strategyText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (strategyText) {
                        setAiStrategy(JSON.parse(strategyText));
                        setIsAICollapsed(false); // Auto expand on new generation
                    }
                } catch (e) {
                    setError(e.message);
                } finally {
                    setIsGeneratingStrategy(false);
                }
            };
            
            const updateCompetitionPeriod = (startDateStr, startHour, startMinute, endDateStr, endHour, endMinute) => {
                if (!startDateStr && !endDateStr) return;
                
                const constructDate = (d, h, m) => {
                    if (!d) return null;
                    const isoLocal = `${d}T${h}:${m}:00+08:00`;
                    return new Date(isoLocal).toISOString();
                };

                const startISO = constructDate(startDateStr, startHour, startMinute);
                const endISO = constructDate(endDateStr, endHour, endMinute);

                const updatedComp = { 
                    ...currentComp, 
                    startDate: startISO || currentComp.startDate,
                    endDate: endISO || currentComp.endDate
                };
                setCompetitions(prev => prev.map(c => c.id === currentComp.id ? updatedComp : c));
                setCurrentComp(updatedComp);
            };

            const hours = Array.from({length: 24}, (_, i) => i.toString().padStart(2, '0'));
            const minutes = ['00', '15', '30', '45'];

            const copyText = (text) => {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            };

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] dark:from-[#0f172a] dark:via-[#000000] dark:to-[#000000] transition-all duration-300 flex flex-col p-2 md:p-4">
                    <div className="max-w-6xl mx-auto flex-1 w-full">
                        {/* Header */}
                        <header className="flex flex-col md:flex-row justify-between mb-4 md:mb-6 gap-2 md:gap-6 items-start md:items-center">
                            <div className="flex w-full md:w-auto flex-col gap-0.5 md:gap-1">
                                {/* Brand Logo & Title Row */}
                                <div className="flex items-center justify-between md:justify-start gap-4">
                                    <div className="flex items-center gap-2 mb-1 animate-in fade-in slide-in-from-left-2">
                                        <svg viewBox="0 0 24 24" className="w-5 h-5 text-[#F0B90B]" fill="currentColor">
                                            <path d="M12 0L9.56 2.44L12 4.88L14.44 2.44L12 0ZM4.88 7.12L2.44 9.56L0 12L2.44 14.44L4.88 16.88L7.32 14.44L4.88 12L7.32 9.56L4.88 7.12ZM19.12 7.12L16.68 9.56L19.12 12L16.68 14.44L19.12 16.88L21.56 14.44L24 12L21.56 9.56L19.12 7.12ZM12 9.12L9.12 12L12 14.88L14.88 12L12 9.12ZM12 19.12L9.56 21.56L12 24L14.44 21.56L12 19.12Z" />
                                        </svg>
                                        <div className="text-xs md:text-sm uppercase tracking-widest text-slate-500 dark:text-slate-400 leading-none flex items-baseline gap-1.5">
                                            <span className="font-black text-slate-900 dark:text-white">Alpha</span>
                                            <span className="font-light opacity-80">Trading Competition</span>
                                        </div>
                                    </div>
                                    
                                    {/* Mobile Settings Button (Moved here for better UX) */}
                                    <div className="md:hidden flex items-center h-10 bg-white dark:bg-slate-800/50 rounded-xl p-1 border border-slate-200 dark:border-slate-700/50 backdrop-blur-md shadow-lg box-border">
                                         <button onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')} className="h-full px-3 rounded-lg text-slate-500 dark:text-slate-400 hover:text-amber-500 dark:hover:text-yellow-400 hover:bg-slate-100 dark:hover:bg-slate-700/50 transition-all flex items-center justify-center">
                                            <Icon name={theme === 'dark' ? 'moon' : 'sun'} size={16} className={theme === 'dark' ? 'text-indigo-400' : 'text-amber-500'} />
                                        </button>
                                        <div className="w-[1px] h-5 bg-slate-200 dark:bg-slate-700 mx-1"></div>
                                        <button onClick={openSettingsModal} className="h-full px-3 rounded-lg text-slate-500 dark:text-slate-400 hover:text-blue-500 dark:hover:text-blue-400 hover:bg-slate-100 dark:hover:bg-slate-700/50 transition-all flex items-center justify-center">
                                            <Icon name="settings" size={16} />
                                        </button>
                                    </div>
                                </div>

                                <div className="flex flex-wrap items-center gap-4">
                                    <button onClick={() => setShowCompModal(true)} className="text-2xl md:text-3xl font-black flex items-center gap-3 text-slate-800 dark:text-white tracking-tight hover:opacity-80 transition-opacity group" title={t.switchCompetition}>
                                        <div className="relative">
                                            <div className={`w-3 h-3 rounded-full animate-pulse relative z-10 bg-${currentComp.color}-500`} />
                                            <div className={`absolute inset-0 rounded-full blur-sm opacity-50 animate-pulse bg-${currentComp.color}-500`} />
                                        </div>
                                        {currentComp.symbol} <span className="text-slate-400 font-light group-hover:text-slate-500 dark:group-hover:text-slate-400 transition-colors text-lg md:text-2xl">DASHBOARD</span>
                                        <Icon name="chevron-down" size={24} className="text-slate-400 group-hover:text-slate-500 dark:text-slate-600 dark:group-hover:text-slate-400 transition-colors" />
                                    </button>
                                </div>
                            </div>
                            
                            {/* Desktop Settings / Mobile Price Only */}
                            <div className="flex gap-3 w-full md:w-auto justify-between md:justify-end items-center">
                                {/* Price Card */}
                                <div className="flex items-center gap-2 px-3 h-10 md:h-12 bg-indigo-50 dark:bg-indigo-900/40 rounded-xl border border-indigo-200 dark:border-indigo-500/30 backdrop-blur-md shadow-lg animate-in fade-in slide-in-from-top-2 group hover:bg-indigo-100 dark:hover:bg-indigo-900/60 transition-all cursor-pointer box-border flex-1 md:flex-none">
                                    <div className={`relative w-6 h-6 rounded-full bg-gradient-to-br ${currentComp.gradient} flex items-center justify-center text-white shadow-inner shrink-0`}>
                                        <Icon name={currentComp.icon} size={12} fill="white" className="text-white" />
                                        {isLivePrice && <span className="absolute -top-0.5 -right-0.5 w-2 h-2 bg-emerald-500 rounded-full border border-white dark:border-[#020617] animate-pulse"></span>}
                                    </div>
                                    <div className="flex flex-row md:flex-col items-center md:items-start gap-2 md:gap-0 leading-none justify-center w-full">
                                        <span className="text-[10px] text-indigo-500 dark:text-indigo-300 font-bold uppercase tracking-wider group-hover:text-indigo-600 dark:group-hover:text-indigo-200 transition-colors flex items-center gap-1">
                                            {currentComp.symbol}/USDT
                                            <span className={`text-[8px] px-1 rounded ${isLivePrice ? 'bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400' : 'bg-slate-200 text-slate-500 dark:bg-slate-500/20 dark:text-slate-400'}`}>
                                                {isLivePrice ? t.priceLive : t.priceEst}
                                            </span>
                                        </span>
                                        {/* Modified: Changed font-mono to font-rounded */}
                                        <span className="text-sm font-rounded font-bold text-slate-800 dark:text-white tracking-tight flex items-center gap-1 ml-auto md:ml-0">
                                            ${coinPrice > 1 ? coinPrice.toLocaleString(undefined, {maximumFractionDigits: 2}) : coinPrice.toFixed(6)}
                                        </span>
                                    </div>
                                </div>

                                {/* Settings Group (Desktop Only) */}
                                <div className="hidden md:flex items-center h-12 bg-white dark:bg-slate-800/50 rounded-xl p-1 border border-slate-200 dark:border-slate-700/50 backdrop-blur-md shadow-lg box-border">
                                    <button onClick={() => setLang('en')} className={`h-full px-3 rounded-lg text-xs font-bold transition-all flex items-center ${lang === 'en' ? 'bg-blue-600 text-white shadow-md' : 'text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700/50'}`}>EN</button>
                                    <button onClick={() => setLang('zh')} className={`h-full px-3 rounded-lg text-xs font-bold transition-all flex items-center ${lang === 'zh' ? 'bg-blue-600 text-white shadow-md' : 'text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700/50'}`}>CN</button>
                                    <div className="w-[1px] h-6 bg-slate-200 dark:bg-slate-700 mx-1"></div>
                                    <button onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')} className="h-full px-3 rounded-lg text-slate-500 dark:text-slate-400 hover:text-amber-500 dark:hover:text-yellow-400 hover:bg-slate-100 dark:hover:bg-slate-700/50 transition-all flex items-center justify-center">
                                        <Icon name={theme === 'dark' ? 'moon' : 'sun'} size={16} className={theme === 'dark' ? 'text-indigo-400' : 'text-amber-500'} />
                                    </button>
                                    <div className="w-[1px] h-6 bg-slate-200 dark:bg-slate-700 mx-1"></div>
                                    <button onClick={openSettingsModal} className="h-full px-3 rounded-lg text-slate-500 dark:text-slate-400 hover:text-blue-500 dark:hover:text-blue-400 hover:bg-slate-100 dark:hover:bg-slate-700/50 transition-all flex items-center justify-center">
                                        <Icon name="settings" size={16} />
                                    </button>
                                </div>
                            </div>
                        </header>

                        {error && (
                            <div className="mb-6 p-4 bg-rose-50 dark:bg-rose-500/10 border border-rose-200 dark:border-rose-500/20 text-rose-600 dark:text-rose-400 rounded-2xl flex justify-between items-center animate-in fade-in slide-in-from-top-2 shadow-sm dark:shadow-[0_0_30px_-10px_rgba(244,63,94,0.2)]">
                                <div className="flex items-center gap-3 text-sm font-bold"><Icon name="alert-triangle" /> {error}</div>
                                <button onClick={() => setError(null)} className="p-1 hover:bg-rose-100 dark:hover:bg-rose-500/20 rounded-lg transition-colors"><Icon name="x" size={18} /></button>
                            </div>
                        )}

                        {/* Draggable Grid */}
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 md:gap-4 mb-8">
                            {cardOrder.map((type, index) => (
                                <div 
                                    key={type}
                                    draggable
                                    onDragStart={(e) => handleDragStart(e, index)}
                                    onDragOver={handleDragOver}
                                    onDragEnter={(e) => handleDragEnter(e, index)}
                                    onDrop={handleDrop}
                                    onDragEnd={handleDragEnd}
                                    className={`draggable-card transition-all duration-300 ${draggedItem === index ? 'dragging' : ''}`}
                                    title="Drag to reorder"
                                >
                                    {renderCard(type)}
                                </div>
                            ))}
                        </div>

                        {/* Main Content Area */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8">
                            
                            {/* Left Column: Status & History */}
                            <div className="lg:col-span-1 flex flex-col gap-6">
                                {/* Status Card */}
                                <div className={`glass-panel p-4 md:p-6 rounded-3xl border-2 relative overflow-hidden transition-all duration-500 bg-white dark:bg-slate-900/60 backdrop-blur-md group hover:-translate-y-1 hover:scale-[1.02] shadow-sm hover:shadow-xl dark:shadow-lg ${
                                    stats.latestUserVolume >= stats.current 
                                    ? 'border-emerald-200 dark:border-emerald-500/60 hover:border-emerald-400 dark:hover:border-emerald-400 shadow-emerald-500/10 dark:shadow-emerald-900/30' 
                                    : 'border-rose-200 dark:border-rose-500/60 hover:border-rose-400 dark:hover:border-rose-400 shadow-rose-500/10 dark:shadow-rose-900/30'
                                }`}>
                                    {/* Scanning Beam */}
                                    <div className="absolute inset-0 pointer-events-none z-0 overflow-hidden rounded-3xl">
                                        <div className={`absolute inset-0 h-full w-full bg-gradient-to-r from-transparent ${stats.latestUserVolume >= stats.current ? 'via-emerald-400/10' : 'via-rose-400/10'} to-transparent animate-shimmer`} style={{willChange: 'transform'}}></div>
                                    </div>

                                    {/* Glow */}
                                    <div className={`absolute -right-6 -top-6 w-32 h-32 rounded-full blur-3xl opacity-20 dark:opacity-30 transition-colors duration-500 animate-pulse ${stats.latestUserVolume >= stats.current ? 'bg-emerald-500' : 'bg-rose-500'}`}></div>
                                    
                                    {/* Watermark Icon */}
                                    <div className={`absolute -right-4 -top-4 opacity-[0.05] group-hover:opacity-[0.1] transition-all duration-500 transform group-hover:scale-110 group-hover:rotate-12 pointer-events-none ${stats.latestUserVolume >= stats.current ? 'text-emerald-500 dark:text-emerald-400' : 'text-rose-500 dark:text-rose-400'}`}>
                                        <Icon name={stats.latestUserVolume >= stats.current ? "shield-check" : "alert-octagon"} size={120} />
                                    </div>
                                    
                                    <div className="flex items-center gap-3 mb-4 relative z-10">
                                        <div className="relative">
                                            <div className={`absolute inset-0 rounded-xl animate-pulse-ring ${stats.latestUserVolume >= stats.current ? 'bg-emerald-500' : 'bg-rose-500'}`}></div>
                                            <div className={`relative w-8 h-8 rounded-xl border flex items-center justify-center transition-colors duration-300 shadow-lg ${
                                                stats.latestUserVolume >= stats.current 
                                                ? 'bg-emerald-100 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-500/30' 
                                                : 'bg-rose-100 dark:bg-rose-500/20 text-rose-600 dark:text-rose-400 border-rose-200 dark:border-rose-500/30'
                                            }`}>
                                                <Icon name={stats.latestUserVolume >= stats.current ? "shield-check" : "alert-octagon"} size={18} />
                                            </div>
                                        </div>
                                        
                                        <div className="text-slate-500 dark:text-slate-400 text-xs font-bold uppercase tracking-widest flex items-center gap-2">
                                            {t.statusTitle}
                                            <span className={`flex w-2 h-2 rounded-full ${stats.latestUserVolume >= stats.current ? 'bg-emerald-500 animate-ping' : 'bg-rose-500 animate-pulse'}`}></span>
                                        </div>
                                    </div>

                                    <div className="flex justify-between items-end mb-4 relative z-10">
                                        <div>
                                            <div className="flex items-baseline gap-1">
                                                <span className={`text-4xl font-black tracking-tight drop-shadow-sm ${
                                                    stats.latestUserVolume >= stats.current 
                                                    ? 'text-emerald-500 dark:text-white' 
                                                    : 'text-rose-500 dark:text-white'
                                                }`}>
                                                    {stats.latestUserVolume >= stats.current ? '+' : ''}
                                                    {stats.current > 0 ? ((stats.latestUserVolume - stats.current) / stats.current * 100).toFixed(2) : 0}
                                                </span>
                                                <span className={`text-xl font-bold ${
                                                    stats.latestUserVolume >= stats.current 
                                                    ? 'text-emerald-500 dark:text-white/80' 
                                                    : 'text-rose-500 dark:text-white/80'
                                                }`}>%</span>
                                            </div>
                                            <div className={`text-xs font-bold mt-1 ${stats.latestUserVolume >= stats.current ? 'text-emerald-600/80 dark:text-emerald-500/80' : 'text-rose-600/80 dark:text-rose-500/80'}`}>
                                                {stats.latestUserVolume >= stats.current ? t.lead : t.lag}
                                            </div>
                                        </div>
                                        <div className="text-right">
                                             <div className="text-[10px] text-slate-400 dark:text-slate-500 font-bold mb-1 uppercase">{t.legendUser}</div>
                                             <div className="text-lg font-rounded font-bold text-slate-800 dark:text-white tracking-tight">${stats.latestUserVolume.toLocaleString()}</div>
                                        </div>
                                    </div>
                                    
                                    {/* Progress Bar */}
                                    <div className="h-2 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden flex relative z-10 border border-slate-200 dark:border-slate-700/50">
                                        <div className={`h-full rounded-full transition-all duration-1000 animate-stripes shadow-[0_0_10px_rgba(0,0,0,0.1)] ${stats.latestUserVolume >= stats.current ? 'bg-emerald-500 w-full' : 'bg-rose-500 w-full'}`}></div>
                                    </div>
                                </div>

                                {/* History List (Consolidated Actions) */}
                                <div className="relative rounded-3xl p-[1px] bg-gradient-to-br from-indigo-300 via-purple-400 to-indigo-400 shadow-sm hover:shadow-xl dark:shadow-lg dark:hover:shadow-indigo-900/30 transition-all duration-300 group hover:-translate-y-1 hover:scale-[1.01] flex flex-col max-h-[350px] lg:max-h-[600px]">
                                    <div className="relative overflow-hidden bg-white dark:bg-[#0f101f]/90 backdrop-blur-md rounded-[23px] flex-1 flex flex-col">
                                        <div className="absolute inset-0 bg-gradient-to-br from-indigo-100/50 dark:from-indigo-900/20 to-transparent opacity-50 pointer-events-none"></div>
                                        <div className="absolute -right-4 -top-4 opacity-[0.15] group-hover:opacity-[0.25] transition-all duration-500 transform group-hover:scale-110 group-hover:-rotate-12 pointer-events-none">
                                            <Icon name="history" size={120} className="text-indigo-500 dark:text-indigo-300" />
                                        </div>

                                        {/* Header & Actions Wrapper */}
                                        <div className="relative z-10 p-4 border-b border-indigo-100 dark:border-indigo-500/20 bg-white/50 dark:bg-slate-900/20 backdrop-blur-sm">
                                            {/* Title Row */}
                                            <div className="flex justify-between items-center mb-3">
                                                <div className="flex items-center gap-3">
                                                    <div className="relative">
                                                        <div className="absolute inset-0 rounded-xl animate-pulse-ring bg-indigo-500"></div>
                                                        <div className="relative z-10 w-8 h-8 rounded-xl border flex items-center justify-center bg-indigo-100 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400 border-indigo-200 dark:border-indigo-500/20">
                                                            <Icon name="list" size={18} />
                                                        </div>
                                                    </div>
                                                    <div className="text-indigo-900/70 dark:text-indigo-200/70 text-xs font-bold uppercase tracking-widest">{t.historySnapshot}</div>
                                                </div>
                                                {/* Modified: Changed font-mono to font-rounded for the count badge */}
                                                <span className="bg-white/80 dark:bg-indigo-900/40 px-2 py-0.5 rounded-lg border border-indigo-200 dark:border-indigo-500/30 text-xs text-indigo-600 dark:text-indigo-300 font-rounded font-bold">
                                                    {dataList.length}
                                                </span>
                                            </div>

                                            {/* Integrated Action Buttons */}
                                            <div className="grid grid-cols-2 gap-2">
                                                <button 
                                                    onClick={handleOpenManualEntry} 
                                                    className="flex items-center justify-center gap-2 py-2 px-3 rounded-xl bg-blue-50 hover:bg-blue-100 dark:bg-blue-500/10 dark:hover:bg-blue-500/20 text-blue-600 dark:text-blue-400 text-xs font-bold transition-all border border-blue-100 dark:border-blue-500/20 active:scale-95"
                                                >
                                                    <Icon name="plus" size={14} /> {t.manualEntry}
                                                </button>

                                                <label className={`flex items-center justify-center gap-2 py-2 px-3 rounded-xl bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-500/10 dark:hover:bg-indigo-500/20 text-indigo-600 dark:text-indigo-400 text-xs font-bold transition-all border border-indigo-100 dark:border-indigo-500/20 active:scale-95 cursor-pointer ${isAnalyzing ? 'opacity-50 cursor-not-allowed' : ''}`}>
                                                    <Icon name={isAnalyzing ? "loader-2" : "image"} size={14} className={isAnalyzing ? "animate-spin" : ""} />
                                                    {isAnalyzing ? t.analyzing : t.importScreenshot}
                                                    <input type="file" className="hidden" onChange={handleFileUpload} accept="image/*" disabled={isAnalyzing} />
                                                </label>
                                            </div>
                                        </div>

                                        {/* List Content */}
                                        <div className="relative z-10 flex-1 overflow-y-auto p-3 space-y-2 custom-scrollbar">
                                            {chartData.slice().reverse().map(item => {
                                                const gap = item.userVolume - item.volume;
                                                const isSafe = gap >= 0;
                                                const gapPercent = item.volume > 0 ? (gap / item.volume * 100) : 0;

                                                return (
                                                    <div key={item.id} className={`group/item relative p-2 border rounded-xl transition-all duration-300 hover:shadow-lg dark:hover:shadow-black/50 backdrop-blur-md overflow-hidden ${
                                                        isSafe 
                                                        ? 'bg-gradient-to-br from-emerald-100/60 to-teal-50/50 dark:from-[#064e3b]/60 dark:to-[#0f766e]/30 border-emerald-200 dark:border-emerald-500/30 hover:border-emerald-300 dark:hover:border-emerald-400/50' 
                                                        : 'bg-gradient-to-br from-rose-100/60 to-orange-50/50 dark:from-[#7f1d1d]/60 dark:to-[#7c2d12]/30 border-rose-200 dark:border-rose-500/30 hover:border-rose-300 dark:hover:border-rose-400/50'
                                                    }`}>
                                                        
                                                        {/* NEW: Decorative Background Watermark */}
                                                        <div className={`absolute -right-4 -bottom-4 opacity-[0.06] dark:opacity-[0.08] transform -rotate-12 scale-150 pointer-events-none transition-transform duration-500 group-hover/item:scale-125 group-hover/item:rotate-0 ${isSafe ? 'text-emerald-800 dark:text-emerald-300' : 'text-rose-800 dark:text-rose-300'}`}>
                                                            <Icon name={isSafe ? "shield-check" : "trending-down"} size={80} />
                                                        </div>
                                                        {/* NEW: Hover Highlight Overlay */}
                                                        <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-white/40 to-transparent dark:from-white/5 opacity-0 group-hover/item:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
                                                        
                                                        {/* Row Header */}
                                                        <div className="flex justify-between items-center mb-1.5 px-1 relative z-10">
                                                            <div className="flex items-center gap-1.5">
                                                                <div className={`w-1.5 h-1.5 rounded-full ${item.source === 'ai' ? 'bg-cyan-400 shadow-sm' : 'bg-purple-400 shadow-sm'}`} />
                                                                {/* Modified: Added font-rounded to Day X */}
                                                                <span className={`text-[10px] font-rounded font-bold ${isSafe ? 'text-emerald-800 dark:text-emerald-200' : 'text-rose-800 dark:text-rose-200'}`}>{item.displayDay}</span>
                                                                
                                                                {/* Date Badge - Compact - Modified: Changed font-mono to font-rounded */}
                                                                <span className={`text-[8px] font-rounded font-bold px-1 py-0.5 rounded-[4px] ml-0.5 shadow-sm leading-none ${
                                                                    isSafe 
                                                                    ? 'bg-emerald-100/80 dark:bg-emerald-500/30 text-emerald-800 dark:text-emerald-100 border border-emerald-200/50 dark:border-emerald-400/20' 
                                                                    : 'bg-rose-100/80 dark:bg-rose-500/30 text-rose-800 dark:text-rose-100 border border-rose-200/50 dark:border-rose-400/20'
                                                                }`}>
                                                                    {new Date(item.timestamp).toLocaleDateString(undefined, {month:'numeric', day:'numeric'})}
                                                                </span>
                                                            </div>
                                                            <button 
                                                                onClick={(e) => {
                                                                    e.stopPropagation();
                                                                    const newData = dataList.filter(d => d.id !== item.id);
                                                                    persistData(newData);
                                                                }} 
                                                                className={`transition-colors opacity-0 group-hover/item:opacity-100 ${isSafe ? 'text-emerald-400 hover:text-emerald-600 dark:text-emerald-500 dark:hover:text-emerald-300' : 'text-rose-400 hover:text-rose-600 dark:text-rose-500 dark:hover:text-rose-300'}`}
                                                                title={t.delete}
                                                            >
                                                                <Icon name="x" size={12} />
                                                            </button>
                                                        </div>

                                                        <div className="grid grid-cols-2 gap-2 relative z-10">
                                                            {/* Threshold - High Contrast Bg */}
                                                            <div className="p-1.5 rounded-lg bg-white/80 dark:bg-black/40 border border-slate-200 dark:border-white/10 flex flex-col justify-center shadow-sm backdrop-blur-sm">
                                                                <span className="text-[8px] text-slate-500 dark:text-slate-400 font-extrabold uppercase flex items-center gap-1 tracking-wider">
                                                                    <Icon name="crosshair" size={8} />
                                                                    {t.legendThreshold}
                                                                </span>
                                                                {/* Modified: font-rounded already present, ensured consistency */}
                                                                <span className="text-sm font-rounded font-bold text-slate-700 dark:text-slate-200 leading-tight mt-0.5">
                                                                    ${item.volume.toLocaleString()}
                                                                </span>
                                                            </div>

                                                            {/* User Volume - Color Coded Bg */}
                                                            <div className={`p-1.5 rounded-lg border flex flex-col justify-center relative overflow-hidden shadow-sm backdrop-blur-sm ${
                                                                isSafe 
                                                                ? 'bg-emerald-100/80 dark:bg-emerald-500/20 border-emerald-200 dark:border-emerald-500/30' 
                                                                : 'bg-rose-100/80 dark:bg-rose-500/20 border-rose-200 dark:border-rose-500/30'
                                                            }`}>
                                                                <span className={`text-[8px] font-extrabold uppercase flex items-center gap-1 tracking-wider ${isSafe ? 'text-emerald-700 dark:text-emerald-400' : 'text-rose-700 dark:text-rose-400'}`}>
                                                                    <Icon name="user" size={8} />
                                                                    {t.legendUser}
                                                                </span>
                                                                
                                                                <div className="flex items-baseline gap-1 mt-0.5">
                                                                    {/* Modified: font-rounded already present */}
                                                                    <span className={`text-sm font-rounded font-bold leading-tight ${isSafe ? 'text-emerald-800 dark:text-white' : 'text-rose-800 dark:text-white'}`}>
                                                                        ${item.userVolume.toLocaleString()}
                                                                    </span>
                                                                    {/* Modified: Font size increased from text-[8px] to text-sm to match volume number */}
                                                                    <span className={`text-sm font-rounded font-extrabold ${isSafe ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400'}`}>
                                                                        {gapPercent > 0 ? '+' : ''}{gapPercent.toFixed(1)}%
                                                                    </span>
                                                                </div>
                                                                
                                                                <div className={`absolute top-1.5 right-1.5 w-1 h-1 rounded-full ${isSafe ? 'bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,0.6)]' : 'bg-rose-500 shadow-[0_0_8px_rgba(244,63,94,0.6)]'}`}></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            {/* Right Column: Unified Market Intelligence Hub */}
                            <div className="lg:col-span-2 flex flex-col h-full">
                                <div className="relative overflow-hidden bg-white dark:bg-slate-900/60 backdrop-blur-md rounded-3xl border border-indigo-200 dark:border-indigo-500/30 shadow-sm hover:shadow-xl dark:shadow-lg dark:hover:shadow-indigo-900/30 transition-all duration-300 flex flex-col h-full">
                                     <div className="absolute inset-0 bg-gradient-to-br from-indigo-100/30 dark:from-indigo-900/10 to-transparent opacity-50 pointer-events-none"></div>
                                    
                                    {/* Container Header */}
                                    <div className="relative z-10 px-5 py-3 border-b border-indigo-100 dark:border-indigo-500/20 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 bg-white/50 dark:bg-slate-900/40">
                                        <div className="flex items-center gap-3">
                                            <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-violet-600 flex items-center justify-center text-white shadow-lg shadow-indigo-500/30">
                                                <Icon name="radar" size={20} />
                                            </div>
                                            <div>
                                                <h2 className="text-lg font-black text-slate-800 dark:text-white tracking-tight flex items-center gap-2">
                                                    Market Intelligence
                                                    <span className="px-1.5 py-0.5 rounded text-[9px] bg-indigo-100 text-indigo-700 dark:bg-indigo-500/20 dark:text-indigo-300 font-mono font-bold uppercase tracking-wider">HUB</span>
                                                </h2>
                                                <div className="text-xs font-medium text-slate-500 dark:text-slate-400">
                                                    {t.growthCurve} & AI Analysis
                                                </div>
                                            </div>
                                        </div>

                                        <div className="flex gap-2 w-full sm:w-auto">
                                             {/* View Toggle */}
                                            <div className="bg-slate-100 dark:bg-slate-800 p-1 rounded-xl flex border border-slate-200 dark:border-slate-700 shrink-0">
                                                <button 
                                                    onClick={() => setChartViewMode('curve')}
                                                    className={`p-2 rounded-lg transition-all ${chartViewMode === 'curve' ? 'bg-white dark:bg-slate-600 shadow-sm text-indigo-500' : 'text-slate-400 hover:text-slate-600 dark:hover:text-slate-300'}`}
                                                    title="Curve View"
                                                >
                                                    <Icon name="waves" size={18} />
                                                </button>
                                                <button 
                                                    onClick={() => setChartViewMode('pixel')}
                                                    className={`p-2 rounded-lg transition-all ${chartViewMode === 'pixel' ? 'bg-white dark:bg-slate-600 shadow-sm text-indigo-500' : 'text-slate-400 hover:text-slate-600 dark:hover:text-slate-300'}`}
                                                    title="Pixel Analysis View"
                                                >
                                                    <Icon name="bar-chart-2" size={18} />
                                                </button>
                                            </div>

                                            <button 
                                                onClick={generateAIStrategy} 
                                                disabled={isGeneratingStrategy}
                                                className="flex-1 sm:flex-none px-4 py-2 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-xl text-xs font-bold flex items-center justify-center gap-2 hover:shadow-lg dark:hover:shadow-[0_0_20px_-5px_rgba(99,102,241,0.6)] border border-white/10 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"
                                            >
                                                <Icon name={isGeneratingStrategy ? "loader-2" : "sparkles"} className={isGeneratingStrategy ? "animate-spin" : ""} size={16} />
                                                {isGeneratingStrategy ? t.aiAnalyzing : t.aiAnalysis}
                                            </button>
                                        </div>
                                    </div>

                                    {/* Content Area */}
                                    <div className="relative z-10 flex-1 flex flex-col p-4 overflow-hidden">
                                        
                                        {/* 1. AI Layer (Collapsible Overlay) */}
                                        {aiStrategy && (
                                            <div className="mb-4 animate-in slide-in-from-top-4 fade-in duration-500">
                                                <div className={`relative overflow-hidden rounded-2xl border transition-all duration-300 ${
                                                    isAICollapsed 
                                                    ? 'bg-slate-50 dark:bg-slate-800/50 border-slate-200 dark:border-slate-700 hover:border-indigo-300 dark:hover:border-indigo-500/50' 
                                                    : 'bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 border-indigo-200 dark:border-indigo-500/30 shadow-lg'
                                                }`}>
                                                    {/* Header / Summary Bar */}
                                                    <div 
                                                        className="p-4 flex items-center justify-between cursor-pointer group select-none"
                                                        onClick={() => setIsAICollapsed(!isAICollapsed)}
                                                    >
                                                        <div className="flex items-center gap-3">
                                                            <div className={`w-8 h-8 rounded-lg flex items-center justify-center transition-colors ${isAICollapsed ? 'bg-slate-200 dark:bg-slate-700 text-slate-500' : 'bg-indigo-100 dark:bg-indigo-500/20 text-indigo-600 dark:text-indigo-400'}`}>
                                                                <Icon name="brain-circuit" size={18} />
                                                            </div>
                                                            <div className="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3">
                                                                <span className="font-bold text-slate-700 dark:text-slate-200 text-sm">{t.geminiInsight}</span>
                                                                {(
                                                                    <div className="flex gap-2">
                                                                        <span className="px-2 py-0.5 bg-white/50 dark:bg-black/20 rounded text-[10px] font-bold text-slate-500 dark:text-slate-400 border border-slate-200 dark:border-slate-700/50">
                                                                            {aiStrategy.marketPhase}
                                                                        </span>
                                                                        <span className={`px-2 py-0.5 rounded text-[10px] font-bold flex items-center gap-1 border ${
                                                                            aiStrategy.riskLevel.includes('High') || aiStrategy.riskLevel.includes('高') 
                                                                            ? 'bg-rose-100/50 dark:bg-rose-500/20 text-rose-600 dark:text-rose-400 border-rose-200 dark:border-rose-500/30' 
                                                                            : 'bg-emerald-100/50 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 border-emerald-200 dark:border-emerald-500/30'
                                                                        }`}>
                                                                            {aiStrategy.riskLevel}
                                                                        </span>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                        <div className="flex items-center gap-2">
                                                             <span className="text-[10px] font-bold text-slate-400 uppercase tracking-wider hidden sm:block">
                                                                {isAICollapsed ? 'Expand Report' : 'Minimize'}
                                                             </span>
                                                             <Icon name={isAICollapsed ? "chevron-down" : "chevron-up"} size={16} className="text-slate-400 group-hover:text-indigo-500 transition-colors" />
                                                        </div>
                                                    </div>

                                                    {/* Full Content (Collapsible) */}
                                                    {!isAICollapsed && (
                                                        <div className="px-4 pb-4 sm:px-6 sm:pb-6 pt-0 animate-in slide-in-from-top-2 fade-in">
                                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4 border-t border-indigo-100/50 dark:border-white/5">
                                                                {/* Left: Analysis */}
                                                                <div className="space-y-3">
                                                                    <p className="text-sm text-slate-600 dark:text-slate-300 leading-relaxed font-medium">
                                                                        {aiStrategy.analysis || aiStrategy.strategy}
                                                                    </p>
                                                                    {aiStrategy.psychologicalTip && (
                                                                        <div className="flex items-start gap-2.5 p-2.5 rounded-lg bg-orange-50/50 dark:bg-orange-500/5 border border-orange-100 dark:border-orange-500/10">
                                                                            <Icon name="coffee" size={14} className="text-orange-400 mt-0.5 shrink-0" />
                                                                            <p className="text-xs font-bold text-orange-700 dark:text-orange-300 italic">"{aiStrategy.psychologicalTip}"</p>
                                                                        </div>
                                                                    )}
                                                                </div>
                                                                
                                                                {/* Right: Advice */}
                                                                <div>
                                                                    <ul className="space-y-2 mb-3">
                                                                        {aiStrategy.actionableAdvice && Array.isArray(aiStrategy.actionableAdvice) ? (
                                                                            aiStrategy.actionableAdvice.map((advice, idx) => (
                                                                                <li key={idx} className="flex gap-2 items-start text-sm text-slate-700 dark:text-slate-200">
                                                                                    <div className="mt-1 w-4 h-4 rounded-full bg-indigo-100 dark:bg-indigo-500/20 flex items-center justify-center text-indigo-600 dark:text-indigo-400 text-[10px] font-bold shrink-0">
                                                                                        {idx + 1}
                                                                                    </div>
                                                                                    <span className="leading-snug">{advice}</span>
                                                                                </li>
                                                                            ))
                                                                        ) : null}
                                                                    </ul>
                                                                    <div className="flex justify-end">
                                                                        <button 
                                                                            className="text-[10px] font-bold text-indigo-500 hover:text-indigo-600 dark:text-indigo-400 dark:hover:text-indigo-300 flex items-center gap-1 transition-colors"
                                                                            onClick={(e) => {
                                                                                e.stopPropagation();
                                                                                copyText(`[AlphaDash AI Report]\nPhase: ${aiStrategy.marketPhase}\nRisk: ${aiStrategy.riskLevel}\n\n${aiStrategy.analysis}\n\nAdvice:\n${aiStrategy.actionableAdvice?.map((a,i)=>`${i+1}. ${a}`).join('\n')}`);
                                                                            }}
                                                                        >
                                                                            <Icon name="copy" size={12} /> COPY
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        )}

                                        {/* 2. Chart Layer (Always Visible) */}
                                        <div className="flex-1 w-full min-h-[300px] md:min-h-[420px] relative">
                                            {chartViewMode === 'curve' ? (
                                                <ResponsiveContainer width="100%" height="100%">
                                                    <AreaChart data={chartData} margin={{ top: 10, right: 10, left: -20, bottom: 0 }}>
                                                        <defs>
                                                            {/* Enhanced Gradients */}
                                                            <linearGradient id="colorVol" x1="0" y1="0" x2="0" y2="1">
                                                                <stop offset="5%" stopColor="#6366f1" stopOpacity={0.4}/>
                                                                <stop offset="95%" stopColor="#6366f1" stopOpacity={0}/>
                                                            </linearGradient>
                                                            <linearGradient id="colorUser" x1="0" y1="0" x2="0" y2="1">
                                                                <stop offset="5%" stopColor="#10b981" stopOpacity={0.4}/>
                                                                <stop offset="95%" stopColor="#10b981" stopOpacity={0}/>
                                                            </linearGradient>
                                                            
                                                            {/* Neon Glow Filter */}
                                                            <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                                                                <feGaussianBlur stdDeviation="2.5" result="coloredBlur" />
                                                                <feMerge>
                                                                    <feMergeNode in="coloredBlur" />
                                                                    <feMergeNode in="SourceGraphic" />
                                                                </feMerge>
                                                            </filter>
                                                        </defs>
                                                        
                                                        <CartesianGrid strokeDasharray="3 3" vertical={false} stroke={theme === 'dark' ? "#1e293b" : "#e2e8f0"} opacity={0.5} />
                                                        
                                                        <XAxis 
                                                            dataKey="displayDay" 
                                                            axisLine={false} 
                                                            tickLine={false} 
                                                            tick={{fontSize:10, fill: theme === 'dark' ? '#64748b' : '#94a3b8', fontWeight:700}} 
                                                            dy={10} 
                                                        />
                                                        <YAxis 
                                                            axisLine={false} 
                                                            tickLine={false} 
                                                            tick={{fontSize:10, fill: theme === 'dark' ? '#64748b' : '#94a3b8', fontWeight:700}} 
                                                            tickFormatter={v => `${(v/1000).toFixed(0)}k`} 
                                                        />
                                                        
                                                        <Tooltip 
                                                            content={<CustomTooltip t={t} />} 
                                                            cursor={{stroke: '#a5b4fc', strokeWidth: 1, strokeDasharray: '5 5', strokeOpacity: 0.5}} 
                                                        />
                                                        
                                                        <Area 
                                                            type="monotone" 
                                                            dataKey="volume" 
                                                            stroke="#6366f1" 
                                                            strokeWidth={3} 
                                                            fill="url(#colorVol)" 
                                                            animationDuration={1500}
                                                            style={{ filter: 'url(#glow)' }}
                                                            activeDot={(props) => (
                                                                <svg>
                                                                    <circle cx={props.cx} cy={props.cy} r={8} fill="#6366f1" opacity="0.3" className="animate-ping" />
                                                                    <circle cx={props.cx} cy={props.cy} r={4} fill="#fff" stroke="#6366f1" strokeWidth={2} />
                                                                </svg>
                                                            )}
                                                        />
                                                        <Area 
                                                            type="monotone" 
                                                            dataKey="userVolume" 
                                                            stroke="#10b981" 
                                                            strokeWidth={3} 
                                                            fill="url(#colorUser)" 
                                                            strokeDasharray="4 4"
                                                            animationDuration={1500}
                                                            style={{ filter: 'url(#glow)' }}
                                                            activeDot={(props) => (
                                                                <svg>
                                                                    <circle cx={props.cx} cy={props.cy} r={8} fill="#10b981" opacity="0.3" className="animate-ping" />
                                                                    <circle cx={props.cx} cy={props.cy} r={4} fill="#fff" stroke="#10b981" strokeWidth={2} />
                                                                </svg>
                                                            )}
                                                        />
                                                    </AreaChart>
                                                </ResponsiveContainer>
                                            ) : (
                                                <PixelChart data={chartData} t={t} />
                                            )}
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Footer Info Cards */}
                    <div className="max-w-6xl mx-auto w-full mt-8 mb-4">
                        <div className="grid grid-cols-2 sm:flex sm:flex-row justify-center items-center gap-3">
                            <div className="flex items-center justify-center gap-2 h-10 px-4 md:px-6 bg-white dark:bg-slate-800/50 rounded-xl border border-slate-200 dark:border-slate-700/50 backdrop-blur-md shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700/80 transition-all cursor-default group">
                                <Icon name="tag" size={16} className="text-slate-500 dark:text-slate-400 group-hover:text-emerald-400 transition-colors" />
                                {/* Modified: Updated version from v8 to v9 */}
                                <span className="text-xs font-bold text-slate-500 dark:text-slate-400 group-hover:text-slate-700 dark:group-hover:text-slate-200 transition-colors">v9</span>
                            </div>

                            <div className="w-[1px] h-6 bg-slate-200 dark:bg-slate-700 hidden sm:block"></div>

                            <a href="https://x.com/" target="_blank" rel="noopener noreferrer" className="flex items-center justify-center gap-2 h-10 px-4 md:px-6 bg-white dark:bg-slate-800/50 rounded-xl border border-slate-200 dark:border-slate-700/50 backdrop-blur-md shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700/80 transition-all active:scale-95 group">
                                <Icon name="twitter" size={16} className="text-slate-500 dark:text-slate-400 group-hover:text-blue-400 transition-colors" />
                                <span className="text-xs font-bold text-slate-500 dark:text-slate-400 group-hover:text-slate-700 dark:group-hover:text-slate-200 transition-colors">{t.followX}</span>
                            </a>

                            <div className="w-[1px] h-6 bg-slate-200 dark:bg-slate-700 hidden sm:block"></div>

                            <button onClick={() => setShowAboutModal(true)} className="flex items-center justify-center gap-2 h-10 px-4 md:px-6 bg-white dark:bg-slate-800/50 rounded-xl border border-slate-200 dark:border-slate-700/50 backdrop-blur-md shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700/80 transition-all active:scale-95 group">
                                <Icon name="info" size={16} className="text-slate-500 dark:text-slate-400 group-hover:text-indigo-400 transition-colors" />
                                <span className="text-xs font-bold text-slate-500 dark:text-slate-400 group-hover:text-slate-700 dark:group-hover:text-slate-200 transition-colors">{t.about}</span>
                            </button>

                            <div className="w-[1px] h-6 bg-slate-200 dark:bg-slate-700 hidden sm:block"></div>

                            <button onClick={() => setShowDonationModal(true)} className="flex items-center justify-center gap-2 h-10 px-4 md:px-6 bg-white dark:bg-slate-800/50 rounded-xl border border-slate-200 dark:border-slate-700/50 backdrop-blur-md shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700/80 transition-all active:scale-95 group">
                                <Icon name="heart" size={16} className="text-slate-500 dark:text-slate-400 group-hover:text-rose-400 transition-colors" />
                                <span className="text-xs font-bold text-slate-500 dark:text-slate-400 group-hover:text-slate-700 dark:group-hover:text-slate-200 transition-colors">{t.donation}</span>
                            </button>
                        </div>
                    </div>

                    {/* Modals */}
                    {showCompModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 dark:bg-black/90 backdrop-blur-xl animate-in fade-in">
                            <div className="w-full max-w-2xl bg-white/90 dark:bg-slate-900/90 border border-slate-200 dark:border-slate-700 rounded-[2rem] p-5 md:p-8 animate-in zoom-in-95 relative overflow-hidden max-h-[90vh] flex flex-col shadow-2xl">
                                <div className="flex justify-between items-center mb-6 md:mb-8 shrink-0">
                                    <h3 className="text-xl md:text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2">
                                        <Icon name="grid" className="text-blue-600 dark:text-blue-500" />
                                        {t.selectCompetition}
                                    </h3>
                                    <button onClick={() => setShowCompModal(false)} className="p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-500 dark:text-slate-400 transition-all"><Icon name="x" size={24} /></button>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-3 gap-4 overflow-y-auto custom-scrollbar p-1">
                                    {competitions.map(comp => (
                                        <div key={comp.id} className="relative group">
                                            <div className="absolute top-2 right-2 flex gap-1 z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                                                <button 
                                                    onClick={(e) => { 
                                                        e.stopPropagation(); 
                                                        openManageModal(comp); 
                                                    }} 
                                                    className="p-1.5 bg-white/90 dark:bg-slate-700/90 hover:bg-blue-50 dark:hover:bg-blue-600 rounded-lg text-slate-500 dark:text-slate-200 shadow-sm border border-slate-200 dark:border-slate-600 transition-colors backdrop-blur-sm" 
                                                    title={t.edit}
                                                >
                                                    <Icon name="edit-2" size={12} />
                                                </button>
                                                {competitions.length > 1 && (
                                                    <button 
                                                        onClick={(e) => handleDeleteRequest(comp.id, e)} 
                                                        className="p-1.5 bg-white/90 dark:bg-slate-700/90 hover:bg-rose-50 dark:hover:bg-rose-600 rounded-lg text-slate-500 dark:text-slate-200 shadow-sm border border-slate-200 dark:border-slate-600 transition-colors backdrop-blur-sm" 
                                                        title={t.delete}
                                                    >
                                                        <Icon name="trash" size={12} />
                                                    </button>
                                                )}
                                            </div>

                                            <button 
                                                onClick={() => {
                                                    setCurrentComp(comp);
                                                    setShowCompModal(false);
                                                }}
                                                className={`w-full relative flex flex-col items-center justify-center p-6 rounded-2xl border transition-all duration-300 ${
                                                    currentComp.id === comp.id 
                                                    ? `bg-slate-50 dark:bg-slate-800 border-${comp.color}-500 ring-2 ring-${comp.color}-500/50`
                                                    : 'bg-white dark:bg-slate-800/40 border-slate-200 dark:border-slate-700/50 hover:bg-slate-50 dark:hover:bg-slate-800 hover:border-slate-300 dark:hover:border-slate-600'
                                                }`}
                                            >
                                                <div className={`w-12 h-12 rounded-full mb-4 flex items-center justify-center bg-gradient-to-br ${comp.gradient} shadow-lg group-hover:scale-110 transition-transform`}>
                                                    <Icon name={comp.icon} size={24} className="text-white" />
                                                </div>
                                                <div className="text-lg font-bold text-slate-700 dark:text-slate-200">{comp.name}</div>
                                                <div className="text-xs font-mono font-bold text-slate-400 dark:text-slate-500 mt-1">{comp.symbol}</div>
                                                
                                                {currentComp.id === comp.id && (
                                                    <div className="absolute top-3 left-3 w-2 h-2 rounded-full bg-emerald-500 shadow-[0_0_10px_rgba(16,185,129,0.5)]"></div>
                                                )}
                                            </button>
                                        </div>
                                    ))}
                                    <button 
                                        onClick={() => openManageModal()}
                                        className="flex flex-col items-center justify-center p-6 rounded-2xl border border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/20 hover:bg-slate-100 dark:hover:bg-slate-800/50 hover:border-slate-400 dark:hover:border-slate-500 transition-all text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300"
                                    >
                                        <div className="w-12 h-12 rounded-full mb-4 flex items-center justify-center bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700">
                                            <Icon name="plus" size={24} />
                                        </div>
                                        <div className="text-sm font-bold">{t.addCompetition}</div>
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showManualModal && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 dark:bg-black/80 backdrop-blur-md animate-in fade-in">
                            <div className="bg-white dark:bg-[#0f172a] border border-slate-200 dark:border-slate-700 w-full max-w-sm rounded-[2rem] shadow-2xl p-6 animate-in zoom-in-95 relative overflow-hidden">
                                <div className="absolute top-0 right-0 w-32 h-32 bg-blue-100 dark:bg-blue-600/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>
                                <div className="flex justify-between items-center mb-6 relative z-10">
                                    <h3 className="font-bold text-xl text-slate-800 dark:text-white">{t.manualModalTitle}</h3>
                                    <button onClick={() => setShowManualModal(false)} className="p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-400 transition-all"><Icon name="x" size={20} /></button>
                                </div>
                                <div className="space-y-4 relative z-10">
                                    <div className="space-y-1">
                                        <label className="text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">{t.dateLabel}</label>
                                        <input type="date" value={manualDate} onChange={e => setManualDate(e.target.value)} className="w-full p-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium text-slate-700 dark:text-slate-200 outline-none transition-all placeholder-slate-400 dark:placeholder-slate-600 text-sm" />
                                    </div>
                                    
                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="space-y-1">
                                            <label className="text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">{t.volumeLabel}</label>
                                            <div className="relative">
                                                <span className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 font-bold text-xs">$</span>
                                                <input type="number" placeholder="Threshold" value={manualVolume} onChange={e => setManualVolume(e.target.value)} className="w-full pl-6 pr-3 py-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono font-bold text-sm text-slate-700 dark:text-slate-200 outline-none transition-all placeholder-slate-400 dark:placeholder-slate-600" />
                                            </div>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">{t.userVolumeLabel}</label>
                                            <div className="relative">
                                                <span className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 font-bold text-xs">$</span>
                                                <input type="number" placeholder="Your Vol" value={manualUserVolume} onChange={e => setManualUserVolume(e.target.value)} className="w-full pl-6 pr-3 py-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 font-mono font-bold text-sm text-slate-700 dark:text-slate-200 outline-none transition-all placeholder-slate-400 dark:placeholder-slate-600" />
                                            </div>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="space-y-1">
                                            <label className="text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">{t.rewardLabel} ({currentComp.symbol})</label>
                                            <div className="relative">
                                                <span className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 font-bold"><Icon name="gift" size={12}/></span>
                                                <input type="number" placeholder="Reward" value={manualReward} onChange={e => setManualReward(e.target.value)} className="w-full pl-8 pr-3 py-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-amber-500 font-mono font-bold text-sm text-slate-700 dark:text-slate-200 outline-none transition-all placeholder-slate-400 dark:placeholder-slate-600" />
                                            </div>
                                        </div>
                                        <div className="space-y-1">
                                            <label className="text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider ml-1">{t.eligibilityLabel}</label>
                                            <div className="relative">
                                                <span className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500 font-bold"><Icon name="list-ordered" size={12}/></span>
                                                <input type="number" placeholder="Rank" value={manualEligibility} onChange={e => setManualEligibility(e.target.value)} className="w-full pl-8 pr-3 py-3 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 font-mono font-bold text-sm text-slate-700 dark:text-slate-200 outline-none transition-all placeholder-slate-400 dark:placeholder-slate-600" />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div className="pt-3 border-t border-slate-200 dark:border-slate-700">
                                        <label className="text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2 block">{t.periodLabel}</label>
                                        <div className="grid grid-cols-2 gap-3">
                                            {/* Start Date & Time */}
                                            <div>
                                                <label className="text-[9px] font-bold text-slate-400 mb-1 block">{t.startLabel}</label>
                                                <div className="flex flex-col gap-1.5">
                                                    <input type="date" value={manualStartDate} onChange={e => setManualStartDate(e.target.value)} className="w-full p-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-200" />
                                                    <div className="flex gap-1">
                                                        <select value={manualStartHour} onChange={e => setManualStartHour(e.target.value)} className="w-1/2 p-1.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-200 appearance-none text-center">
                                                            {hours.map(h => <option key={h} value={h}>{h}</option>)}
                                                        </select>
                                                        <select value={manualStartMinute} onChange={e => setManualStartMinute(e.target.value)} className="w-1/2 p-1.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-200 appearance-none text-center">
                                                            {minutes.map(m => <option key={m} value={m}>{m}</option>)}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            {/* End Date & Time */}
                                            <div>
                                                <label className="text-[9px] font-bold text-slate-400 mb-1 block">{t.endLabel}</label>
                                                <div className="flex flex-col gap-1.5">
                                                    <input type="date" value={manualEndDate} onChange={e => setManualEndDate(e.target.value)} className="w-full p-2 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-200" />
                                                    <div className="flex gap-1">
                                                        <select value={manualEndHour} onChange={e => setManualEndHour(e.target.value)} className="w-1/2 p-1.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-200 appearance-none text-center">
                                                            {hours.map(h => <option key={h} value={h}>{h}</option>)}
                                                        </select>
                                                        <select value={manualEndMinute} onChange={e => setManualEndMinute(e.target.value)} className="w-1/2 p-1.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-xs font-bold text-slate-700 dark:text-slate-200 appearance-none text-center">
                                                            {minutes.map(m => <option key={m} value={m}>{m}</option>)}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <button onClick={() => {
                                        updateCompetitionPeriod(manualStartDate, manualStartHour, manualStartMinute, manualEndDate, manualEndHour, manualEndMinute);
                                        
                                        if(manualVolume) {
                                            const newData = [...dataList, { 
                                                id: Date.now(), 
                                                volume: parseFloat(manualVolume), 
                                                userVolume: manualUserVolume ? parseFloat(manualUserVolume) : 0,
                                                reward: manualReward ? parseFloat(manualReward) : (stats.latestReward || 0),
                                                eligibility: manualEligibility ? parseFloat(manualEligibility) : (stats.latestEligibility || 0),
                                                timestamp: new Date(manualDate).toISOString(), 
                                                source: 'manual' 
                                            }];
                                            persistData(newData);
                                        }
                                        setShowManualModal(false);
                                        setManualVolume('');
                                        setManualUserVolume('');
                                        setManualReward('');
                                        setManualEligibility('');
                                    }} className="w-full py-4 bg-blue-600 text-white font-bold rounded-xl shadow-lg shadow-blue-500/30 dark:shadow-[0_0_20px_-5px_rgba(37,99,235,0.5)] hover:bg-blue-500 hover:shadow-xl dark:hover:shadow-[0_0_30px_-5px_rgba(37,99,235,0.7)] transition-all active:scale-[0.98] mt-2 border border-blue-400/20">
                                        {t.confirmButton}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showSettingsModal && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 dark:bg-black/90 backdrop-blur-md animate-in fade-in">
                            <div className="bg-white dark:bg-[#0f172a] border border-slate-200 dark:border-slate-700 w-full max-w-sm rounded-[2rem] shadow-2xl p-5 md:p-8 animate-in zoom-in-95">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2">
                                        <Icon name="settings" className="text-blue-500" />
                                        {t.settings}
                                    </h3>
                                    <button onClick={() => setShowSettingsModal(false)} className="p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full text-slate-500 dark:text-slate-400 transition-all"><Icon name="x" size={20} /></button>
                                </div>
                                
                                <div className="space-y-4">
                                    <div className="space-y-3">
                                        <label className="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider block mb-1.5">{t.apiKeyLabel}</label>
                                        
                                        {/* Key 1 (Primary) */}
                                        <div className="space-y-1">
                                            <span className="text-[9px] font-bold text-indigo-500 dark:text-indigo-400 uppercase tracking-wide">{t.key1Label}</span>
                                            <input 
                                                type="password" 
                                                value={tempKeys[0]} 
                                                onChange={e => {
                                                    const newKeys = [...tempKeys];
                                                    newKeys[0] = e.target.value;
                                                    setTempKeys(newKeys);
                                                }} 
                                                className="w-full p-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-900 dark:text-white outline-none focus:border-blue-500 text-sm" 
                                                placeholder={t.apiKeyPlaceholder} 
                                            />
                                        </div>

                                        {/* Key 2 (Backup) */}
                                        <div className="space-y-1">
                                            <span className="text-[9px] font-bold text-slate-400 uppercase tracking-wide">{t.key2Label}</span>
                                            <input 
                                                type="password" 
                                                value={tempKeys[1]} 
                                                onChange={e => {
                                                    const newKeys = [...tempKeys];
                                                    newKeys[1] = e.target.value;
                                                    setTempKeys(newKeys);
                                                }} 
                                                className="w-full p-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-900 dark:text-white outline-none focus:border-blue-500 text-sm" 
                                                placeholder={`${t.apiKeyPlaceholder} (Optional)`} 
                                            />
                                        </div>

                                        {/* Key 3 (Backup) */}
                                        <div className="space-y-1">
                                            <span className="text-[9px] font-bold text-slate-400 uppercase tracking-wide">{t.key3Label}</span>
                                            <input 
                                                type="password" 
                                                value={tempKeys[2]} 
                                                onChange={e => {
                                                    const newKeys = [...tempKeys];
                                                    newKeys[2] = e.target.value;
                                                    setTempKeys(newKeys);
                                                }} 
                                                className="w-full p-2.5 bg-slate-50 dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-slate-900 dark:text-white outline-none focus:border-blue-500 text-sm" 
                                                placeholder={`${t.apiKeyPlaceholder} (Optional)`} 
                                            />
                                        </div>

                                        <p className="text-[10px] text-slate-400 dark:text-slate-500 mt-2 leading-relaxed">{t.apiKeyHint}</p>
                                    </div>

                                    {/* Data Management Section */}
                                    <div className="pt-4 border-t border-slate-100 dark:border-slate-800">
                                        <label className="text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider block mb-2">{t.dataMgmt}</label>
                                        <div className="grid grid-cols-2 gap-3">
                                            <button 
                                                onClick={handleExportData}
                                                className="flex flex-col items-center justify-center p-3 rounded-xl bg-indigo-50 dark:bg-indigo-500/10 border border-indigo-100 dark:border-indigo-500/20 hover:bg-indigo-100 dark:hover:bg-indigo-500/20 transition-all group"
                                            >
                                                <Icon name="download" className="text-indigo-500 mb-1" />
                                                <span className="text-[10px] font-bold text-indigo-600 dark:text-indigo-300">{t.exportData}</span>
                                            </button>
                                            
                                            <label className="flex flex-col items-center justify-center p-3 rounded-xl bg-emerald-50 dark:bg-emerald-500/10 border border-emerald-100 dark:border-emerald-500/20 hover:bg-emerald-100 dark:hover:bg-emerald-500/20 transition-all cursor-pointer group">
                                                <Icon name="upload" className="text-emerald-500 mb-1" />
                                                <span className="text-[10px] font-bold text-emerald-600 dark:text-emerald-300">{t.importData}</span>
                                                <input type="file" accept=".json" onChange={handleImportData} className="hidden" />
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div className="flex gap-3 pt-4 border-t border-slate-100 dark:border-slate-800">
                                        <button onClick={clearKey} className="flex-1 py-2.5 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">{t.clearKey}</button>
                                        <button onClick={confirmSaveKey} className="flex-1 py-2.5 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-500 transition-colors shadow-lg shadow-blue-500/20 dark:shadow-blue-900/20">{t.saveKey}</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {showDeleteModal && (
                         <div className="fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/50 dark:bg-black/90 backdrop-blur-md animate-in fade-in">
                            <div className="bg-white dark:bg-[#0f172a] border border-slate-200 dark:border-slate-700 w-full max-w-sm rounded-[2rem] shadow-2xl p-6 animate-in zoom-in-95">
                                <div className="text-center mb-6">
                                    <div className="w-16 h-16 bg-rose-100 dark:bg-rose-500/20 rounded-full flex items-center justify-center mx-auto mb-4 text-rose-600 dark:text-rose-500 animate-pulse-fast">
                                        <Icon name="alert-triangle" size={32} />
                                    </div>
                                    <h3 className="text-xl font-bold text-slate-800 dark:text-white mb-2">{t.deleteConfirmTitle}</h3>
                                    <p className="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">{t.deleteConfirmDesc}</p>
                                </div>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowDeleteModal(false)} className="flex-1 py-3 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">{t.cancel}</button>
                                    <button onClick={confirmDeleteCompetition} className="flex-1 py-3 bg-rose-600 text-white font-bold rounded-xl hover:bg-rose-500 transition-colors shadow-lg shadow-rose-500/30">{t.confirmDelete}</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showAboutModal && (
                        <div className="fixed inset-0 z-[80] flex items-center justify-center p-4 bg-black/50 dark:bg-black/90 backdrop-blur-md animate-in fade-in">
                            <div className="bg-white dark:bg-[#0f172a] border border-slate-200 dark:border-slate-700 w-full max-w-sm rounded-[2rem] shadow-2xl p-8 animate-in zoom-in-95 relative overflow-hidden">
                                <div className="absolute top-0 right-0 w-32 h-32 bg-indigo-100 dark:bg-indigo-600/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>
                                <div className="text-center mb-6 relative z-10">
                                    <div className="w-16 h-16 bg-indigo-50 dark:bg-indigo-500/10 rounded-full flex items-center justify-center mx-auto mb-4 text-indigo-600 dark:text-indigo-400 border border-indigo-100 dark:border-indigo-500/20 shadow-sm">
                                        <Icon name="info" size={32} />
                                    </div>
                                    <h3 className="text-xl font-bold text-slate-800 dark:text-white mb-2">{t.aboutTitle}</h3>
                                    <p className="text-sm text-slate-500 dark:text-slate-400 leading-relaxed">{t.aboutDesc}</p>
                                </div>
                                <button onClick={() => setShowAboutModal(false)} className="w-full py-3 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">{t.cancel}</button>
                            </div>
                        </div>
                    )}

                    {showDonationModal && (
                        <div className="fixed inset-0 z-[80] flex items-center justify-center p-4 bg-black/50 dark:bg-black/90 backdrop-blur-md animate-in fade-in">
                            <div className="relative w-full max-w-sm rounded-[2rem] shadow-2xl p-8 animate-in zoom-in-95 overflow-hidden border border-rose-100 dark:border-rose-900/30 bg-gradient-to-br from-rose-50 via-white to-pink-50 dark:from-[#2a0a12] dark:via-[#1a0508] dark:to-[#0f0204]">
                                
                                {/* Decorative Background Flares */}
                                <div className="absolute top-0 right-0 w-64 h-64 bg-gradient-to-br from-rose-200/40 to-pink-200/40 dark:from-rose-600/10 dark:to-pink-600/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>
                                <div className="absolute bottom-0 left-0 w-48 h-48 bg-gradient-to-tr from-red-200/30 to-orange-200/30 dark:from-red-600/10 dark:to-orange-600/10 rounded-full blur-3xl translate-y-1/2 -translate-x-1/2 pointer-events-none"></div>

                                <div className="text-center relative z-10 flex flex-col h-full">
                                    {/* 3D Realistic Heart Icon */}
                                    <div className="w-20 h-20 mx-auto mb-6 relative group cursor-pointer">
                                        {/* Outer Glow/Pulse */}
                                        <div className="absolute inset-0 bg-rose-500 rounded-full animate-ping opacity-20 duration-[2000ms]"></div>
                                        
                                        {/* The 3D Sphere */}
                                        <div className="relative w-full h-full rounded-full bg-gradient-to-br from-rose-400 via-rose-500 to-red-600 flex items-center justify-center shadow-xl shadow-rose-500/40 dark:shadow-rose-900/50 border-4 border-white dark:border-[#2a0a12] transform transition-transform group-hover:scale-110 duration-300">
                                            <Icon name="heart" size={32} className="text-white fill-rose-100/20 drop-shadow-md" />
                                        </div>
                                        
                                        {/* Glossy Highlight (The "Gem" Effect) */}
                                        <div className="absolute top-3 right-5 w-5 h-2 bg-white/40 rounded-full rotate-[-45deg] blur-[1px]"></div>
                                        <div className="absolute bottom-3 left-5 w-2 h-2 bg-white/20 rounded-full blur-[2px]"></div>
                                    </div>
                                    
                                    <h3 className="text-2xl font-black text-rose-950 dark:text-rose-100 mb-2 tracking-tight">{t.donationTitle}</h3>
                                    <p className="text-sm font-medium text-rose-700/70 dark:text-rose-300/70 leading-relaxed mb-6">{t.donationDesc}</p>
                                    
                                    {/* Network Tabs */}
                                    <div className="flex p-1 bg-rose-100 dark:bg-rose-900/20 rounded-xl mb-5">
                                        <button 
                                            onClick={() => setDonateTab('bsc')} 
                                            className={`flex-1 py-2 rounded-lg text-xs font-bold transition-all duration-300 ${donateTab === 'bsc' ? 'bg-white dark:bg-rose-600 shadow-md text-rose-600 dark:text-white' : 'text-rose-400 hover:text-rose-500'}`}
                                        >
                                            USDT (BEP20)
                                        </button>
                                        <button 
                                            onClick={() => setDonateTab('sol')} 
                                            className={`flex-1 py-2 rounded-lg text-xs font-bold transition-all duration-300 ${donateTab === 'sol' ? 'bg-white dark:bg-rose-600 shadow-md text-rose-600 dark:text-white' : 'text-rose-400 hover:text-rose-500'}`}
                                        >
                                            USDC (SOL)
                                        </button>
                                    </div>

                                    {/* QR Code Container */}
                                    <div className="mx-auto bg-white p-3 rounded-2xl shadow-sm border border-rose-100 mb-5">
                                        <img 
                                            src={`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${currentAddress}&color=be123c`} 
                                            alt="Wallet QR Code" 
                                            className="w-32 h-32 rounded-lg mix-blend-multiply opacity-90 transition-all duration-300"
                                        />
                                    </div>

                                    {/* Full Address Card */}
                                    <div 
                                        className="group relative bg-white/60 dark:bg-rose-950/40 rounded-xl border border-rose-200/50 dark:border-rose-900/30 p-3 text-left cursor-pointer hover:bg-white hover:border-rose-300 dark:hover:bg-rose-900/60 transition-all mb-6"
                                        onClick={() => copyText(currentAddress)}
                                    >
                                        <div className="flex justify-between items-start gap-3">
                                            <div className="flex-1 min-w-0">
                                                <div className="text-[9px] font-bold text-rose-400 uppercase tracking-wider mb-1">
                                                    Wallet Address
                                                </div>
                                                <div className="text-xs font-mono font-bold text-rose-900 dark:text-rose-100 break-all leading-relaxed">
                                                    {currentAddress}
                                                </div>
                                            </div>
                                            <div className="w-8 h-8 rounded-lg bg-rose-100 dark:bg-rose-900/40 flex items-center justify-center text-rose-500 shrink-0 group-hover:scale-110 transition-transform">
                                                <Icon name="copy" size={14} />
                                            </div>
                                        </div>
                                        <div className="absolute inset-0 border-2 border-rose-400 rounded-xl opacity-0 group-hover:opacity-100 scale-95 group-hover:scale-100 transition-all pointer-events-none"></div>
                                    </div>

                                    <button onClick={() => setShowDonationModal(false)} className="w-full py-3.5 bg-gradient-to-r from-rose-500 to-red-600 text-white font-bold rounded-xl shadow-lg shadow-rose-500/30 hover:shadow-xl hover:scale-[1.02] active:scale-[0.98] transition-all">
                                        {t.cancel}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>